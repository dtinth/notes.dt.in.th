<!DOCTYPE html>
<html data-precompiled=true lang="en" data-dtinth="true">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/icon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Analyzing and optimizing Next.js bundle size | notes.dt.in.th</title><meta property="og:title" content="Analyzing and optimizing Next.js bundle size" data-source="note">
<meta property="og:image" content="https://screenshot.source.in.th/image/_/notes/NextBundleSize" data-source="note">
<meta property="og:image:width" content="1800" data-source="note">
<meta property="og:image:height" content="1680" data-source="note">
<link rel="canonical" href="https://notes.dt.in.th/NextBundleSize" data-source="note"><style id="note-styles">/* layer: default */
.static[data-v-8c9498c0]{position:static;}
.table[data-v-8c9498c0]{display:table;}</style>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"
      integrity="sha256-dY2Ug42wyv3rl+sLVKEg3jbPs8f+hi7tmJ836AxVDwI="
      crossorigin="anonymous"
    ></script>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/blurhash-image@1.0.1/blurhash-image.min.js"
      integrity="sha256-qrUUgTGk7xA7iVCwraHNQjwy2JryA0K4L3DL4qidagQ="
      crossorigin="anonymous"
    ></script>
    <script type="module" crossorigin src="/runtime/index.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/supabase-CjkNZD6A.js">
    <link rel="stylesheet" crossorigin href="/runtime/index.css">
  </head>
  <body class="bg-#252423 text-#e9e8e7 antialiased">
    <header class="h-[58px] bg-#090807 border-b border-#454443 z-20 flex">
      <div class="flex items-center pl-[18px] flex-none">
        <a
          class="flex items-center text-#8b8685 hover:text-#ffffbb text-lg"
          href="/"
          >notes.dt.in.th</a
        >
      </div>
      <div
        class="flex-1 flex items-center text-#8b8685 [&_a:hover]:text-#ffffbb overflow-hidden"
        id="headerMiddle"
      >
        <div class="px-2 flex-none">›</div><div class="truncate"><a title="Cloud Platform (topic)" href="CloudPlatform">Cloud Platform</a></div><div class="px-2 flex-none">›</div><div class="truncate"><a title="Vercel (topic)" href="Vercel">Vercel</a></div><div class="px-2 flex-none">›</div><div class="truncate"><a title="Next.js (topic)" href="Next">Next.js</a></div><div class="px-2 flex-none">›</div><div class="truncate"><a title="Production-grade Next.js apps" href="NextInProduction">Production-grade Next.js apps</a></div>
      </div>
      <div
        class="flex items-center px-[18px] flex-none gap-4"
        id="headerToolbar"
      ></div>
    </header>
    <div class="h-entry">
      <main class="bg-#353433" id="main">
        <div class="notes-layout-container mx-auto p-6 py-12" id="mainContents">
          <div class="prose e-content" id="noteContents"><!--[--><h1 id="analyzing-nextjs-bundle-size" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#analyzing-nextjs-bundle-size" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Analyzing Next.js bundle size</h1><div class="lead" data-v-8c9498c0><p data-v-8c9498c0>When building a <a href="NextInProduction" data-v-8c9498c0>production-grade Next.js app</a>,** you may eventually run into problems with large bundle size:</p></div><p data-v-8c9498c0><img src="https://user-images.githubusercontent.com/193136/194515122-7777ec2b-36d1-489a-bc5a-f2c4364e4177.png" alt="" data-v-8c9498c0></p><h2 id="easy-case--direct-dependencies" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#easy-case--direct-dependencies" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Easy case — direct dependencies</h2><p data-v-8c9498c0>The first thing to do is to use <a href="https://www.npmjs.com/package/@next/bundle-analyzer" data-v-8c9498c0><code data-v-8c9498c0>@next/bundle-analyzer</code></a> to analyze the bundle size.</p><p data-v-8c9498c0>This can generate a report that looks like this:</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/obv.jpeg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>In this case, it is obvious what is going on. We are importing the whole Font Awesome library, which is huge. We can easily optimize this by importing just the icons we need.</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#FDAEB7;" data-v-8c9498c0>-import { far } from &#39;@fortawesome/pro-regular-svg-icons&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#85E89D;" data-v-8c9498c0>+import { faEnvelope } from &#39;@fortawesome/pro-regular-svg-icons/faEnvelope&#39;</span></span></code></pre><h2 id="complicated-case--transitive-dependencies" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#complicated-case--transitive-dependencies" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Complicated case — transitive dependencies</h2><p data-v-8c9498c0>This is where official help from Next.js framework ended.</p><p data-v-8c9498c0>But things can still get more complicated when the bundle size is large, not because of direct dependencies, but because of <strong data-v-8c9498c0>dependencies of dependencies</strong> <em data-v-8c9498c0>(transitive dependencies).</em></p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/transitive.jpeg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>In the example above, it seems like <strong data-v-8c9498c0>an HTML5 parser</strong> and the <strong data-v-8c9498c0><a href="https://www.npmjs.com/package/cheerio" data-v-8c9498c0>cheerio</a></strong> library is included in the bundle. <em data-v-8c9498c0>But why?</em> We are not doing any HTML parsing in our app, so it must be one of our dependencies that we use that pulls in these libraries.</p><p data-v-8c9498c0>The <a href="https://www.npmjs.com/package/@next/bundle-analyzer" data-v-8c9498c0><code data-v-8c9498c0>@next/bundle-analyzer</code></a> plugin shows the size of each module, but <strong data-v-8c9498c0>it does not tell us why that module is included in the bundle in the first place.</strong> To find that out, we need more information about the build process.</p><h3 id="generating-a-stats-file" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#generating-a-stats-file" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Generating a stats file</h3><p data-v-8c9498c0>Under the hood, <code data-v-8c9498c0>@next/bundle-analyzer</code> uses <a href="https://www.npmjs.com/package/webpack-bundle-analyzer" data-v-8c9498c0><code data-v-8c9498c0>webpack-bundle-analyzer</code></a> to generate the report. We can use <em data-v-8c9498c0>that</em> to generate a stats file that shows the <strong data-v-8c9498c0>reasons</strong> why each module is included in the bundle by passing the <a href="https://www.npmjs.com/package/webpack-bundle-analyzer#:~:text=in%20default%20browser.-,generateStatsFile,-%7BBoolean%7D" data-v-8c9498c0><code data-v-8c9498c0>generateStatsFile</code></a> option.</p><p data-v-8c9498c0>However, <code data-v-8c9498c0>@next/bundle-analyzer</code> <a href="https://github.com/vercel/next.js/blob/04c2509daaa6ceae7882598b933f9580ca874517/packages/next-bundle-analyzer/index.js#L9-L17" data-v-8c9498c0>has hardcoded the options passed to <code data-v-8c9498c0>webpack-bundle-analyzer</code></a>, so turning that option on requires some hackery.</p><p data-v-8c9498c0>Edit <code data-v-8c9498c0>node_modules/@next/bundle-analyzer/index.js</code> and add the <code data-v-8c9498c0>generateStatsFile</code> option to the <code data-v-8c9498c0>webpack-bundle-analyzer</code> options:</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>           config.plugins.push(</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>             new BundleAnalyzerPlugin({</span></span>
<span class="line" data-v-8c9498c0><span style="color:#85E89D;" data-v-8c9498c0>+              generateStatsFile: true,</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>               analyzerMode: &#39;static&#39;,</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>               openAnalyzer,</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>               reportFilename: options.isServer</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>                 ? &#39;../analyze/server.html&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>                 : &#39;./analyze/client.html&#39;,</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>             })</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>           )</span></span></code></pre><p data-v-8c9498c0>Build the app again. This time, the console should now show the path to the stats file:</p><pre data-v-8c9498c0><code data-v-8c9498c0>Webpack Bundle Analyzer saved report to /.../.next/analyze/client.html
Webpack Bundle Analyzer saved stats file to /.../.next/stats.json
</code></pre><h3 id="exploring-the-stats-file" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#exploring-the-stats-file" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Exploring the stats file</h3><p data-v-8c9498c0>The stats file is a JSON file that contains a lot of information about the build process. Fortunately, the webpack project provides the <a href="https://webpack.github.io/analyse/" data-v-8c9498c0><strong data-v-8c9498c0>analyze</strong></a> tool to help us explore it.</p><p data-v-8c9498c0>When you open the stats file in the analyze tool, and click on the <strong data-v-8c9498c0>Modules</strong> tab.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/analyze-home.jpeg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>You will see module graph, and a table of modules.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/analyze-modules.jpeg" alt="" data-v-8c9498c0></p><h3 id="finding-the-culprit" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#finding-the-culprit" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Finding the culprit</h3><p data-v-8c9498c0>Search for the module you want to find. In this case, we are looking for <code data-v-8c9498c0>cheerio</code>. Once you find it, click on the module ID to inspect it. Also take note of the ID, it will become useful later (in this case, 848).</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/analyze-find.jpeg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>The module graph will update to highlight the selected module.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/analyze-mod.jpeg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>Scroll your mouse wheel to zoom in and out.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/analyze-mod-graph.jpeg" alt="" data-v-8c9498c0></p><ul data-v-8c9498c0><li data-v-8c9498c0>The module being inspected is highlighted in <strong data-v-8c9498c0>black</strong>.</li><li data-v-8c9498c0>The modules that depend on the module (‘reasons’) are highlighted in <strong data-v-8c9498c0>red</strong>.</li><li data-v-8c9498c0>The dependencies of the module are highlighted in <strong data-v-8c9498c0>green</strong>.</li></ul><p data-v-8c9498c0>The same information can be seen below the graph in the <strong data-v-8c9498c0>reasons</strong> and <strong data-v-8c9498c0>dependencies</strong> sections.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/analyze-mod-table.jpeg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0><strong data-v-8c9498c0>Keep following the reasons</strong> until you find the culprit in your code.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2022/12/13/analyze-trail.jpeg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>In our case,</p><ul data-v-8c9498c0><li data-v-8c9498c0>We have a module <code data-v-8c9498c0>./src/utils/Helper.ts</code> which is a collection of helper functions.</li><li data-v-8c9498c0>One of the helper function imports <code data-v-8c9498c0>juice</code>, which imports <code data-v-8c9498c0>cheerio</code>, which imports <code data-v-8c9498c0>htmlparser2</code>. This helper function is only used in the server-side code.</li><li data-v-8c9498c0>However, many client-side modules also imports <code data-v-8c9498c0>./src/utils/Helper.ts</code>, which caused juice, along with its dependencies, to be included in the client-side bundle.</li></ul><p data-v-8c9498c0>So the solution to optimize the bundle size in this scenario is to separate the <code data-v-8c9498c0>Helpers</code> module into two, one for the server and one for the client.</p><!--]--></div>
        </div>
      </main>
      <footer>
        <div
          class="notes-layout-container mx-auto py-4 px-6 text-#8b8685 text-right text-sm"
          id="footerContents"
        >
          <notes-page-footer></notes-page-footer>
        </div>
      </footer>
    </div>
    <script>
window.precompiledNoteBehavior = function(require, exports, module, Vue) {"use strict";Object.defineProperty(exports, "__esModule", {value: true});const __sfc__ = {};
var _vue = require('vue');

const _withScopeId = n => (_vue.pushScopeId.call(void 0, "data-v-8c9498c0"),n=n(),_vue.popScopeId.call(void 0, ),n)
const _hoisted_1 = /*#__PURE__*/_vue.createStaticVNode.call(void 0, "<h1 id=\"analyzing-nextjs-bundle-size\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#analyzing-nextjs-bundle-size\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Analyzing Next.js bundle size</h1><div class=\"lead\" data-v-8c9498c0><p data-v-8c9498c0>When building a <a href=\"NextInProduction\" data-v-8c9498c0>production-grade Next.js app</a>,** you may eventually run into problems with large bundle size:</p></div><p data-v-8c9498c0><img src=\"https://user-images.githubusercontent.com/193136/194515122-7777ec2b-36d1-489a-bc5a-f2c4364e4177.png\" alt=\"\" data-v-8c9498c0></p><h2 id=\"easy-case--direct-dependencies\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#easy-case--direct-dependencies\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Easy case — direct dependencies</h2><p data-v-8c9498c0>The first thing to do is to use <a href=\"https://www.npmjs.com/package/@next/bundle-analyzer\" data-v-8c9498c0><code data-v-8c9498c0>@next/bundle-analyzer</code></a> to analyze the bundle size.</p><p data-v-8c9498c0>This can generate a report that looks like this:</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/obv.jpeg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>In this case, it is obvious what is going on. We are importing the whole Font Awesome library, which is huge. We can easily optimize this by importing just the icons we need.</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#FDAEB7;\" data-v-8c9498c0>-import { far } from &#39;@fortawesome/pro-regular-svg-icons&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#85E89D;\" data-v-8c9498c0>+import { faEnvelope } from &#39;@fortawesome/pro-regular-svg-icons/faEnvelope&#39;</span></span></code></pre><h2 id=\"complicated-case--transitive-dependencies\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#complicated-case--transitive-dependencies\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Complicated case — transitive dependencies</h2><p data-v-8c9498c0>This is where official help from Next.js framework ended.</p><p data-v-8c9498c0>But things can still get more complicated when the bundle size is large, not because of direct dependencies, but because of <strong data-v-8c9498c0>dependencies of dependencies</strong> <em data-v-8c9498c0>(transitive dependencies).</em></p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/transitive.jpeg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>In the example above, it seems like <strong data-v-8c9498c0>an HTML5 parser</strong> and the <strong data-v-8c9498c0><a href=\"https://www.npmjs.com/package/cheerio\" data-v-8c9498c0>cheerio</a></strong> library is included in the bundle. <em data-v-8c9498c0>But why?</em> We are not doing any HTML parsing in our app, so it must be one of our dependencies that we use that pulls in these libraries.</p><p data-v-8c9498c0>The <a href=\"https://www.npmjs.com/package/@next/bundle-analyzer\" data-v-8c9498c0><code data-v-8c9498c0>@next/bundle-analyzer</code></a> plugin shows the size of each module, but <strong data-v-8c9498c0>it does not tell us why that module is included in the bundle in the first place.</strong> To find that out, we need more information about the build process.</p><h3 id=\"generating-a-stats-file\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#generating-a-stats-file\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Generating a stats file</h3><p data-v-8c9498c0>Under the hood, <code data-v-8c9498c0>@next/bundle-analyzer</code> uses <a href=\"https://www.npmjs.com/package/webpack-bundle-analyzer\" data-v-8c9498c0><code data-v-8c9498c0>webpack-bundle-analyzer</code></a> to generate the report. We can use <em data-v-8c9498c0>that</em> to generate a stats file that shows the <strong data-v-8c9498c0>reasons</strong> why each module is included in the bundle by passing the <a href=\"https://www.npmjs.com/package/webpack-bundle-analyzer#:~:text=in%20default%20browser.-,generateStatsFile,-%7BBoolean%7D\" data-v-8c9498c0><code data-v-8c9498c0>generateStatsFile</code></a> option.</p><p data-v-8c9498c0>However, <code data-v-8c9498c0>@next/bundle-analyzer</code> <a href=\"https://github.com/vercel/next.js/blob/04c2509daaa6ceae7882598b933f9580ca874517/packages/next-bundle-analyzer/index.js#L9-L17\" data-v-8c9498c0>has hardcoded the options passed to <code data-v-8c9498c0>webpack-bundle-analyzer</code></a>, so turning that option on requires some hackery.</p><p data-v-8c9498c0>Edit <code data-v-8c9498c0>node_modules/@next/bundle-analyzer/index.js</code> and add the <code data-v-8c9498c0>generateStatsFile</code> option to the <code data-v-8c9498c0>webpack-bundle-analyzer</code> options:</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>           config.plugins.push(</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>             new BundleAnalyzerPlugin({</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#85E89D;\" data-v-8c9498c0>+              generateStatsFile: true,</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>               analyzerMode: &#39;static&#39;,</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>               openAnalyzer,</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>               reportFilename: options.isServer</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>                 ? &#39;../analyze/server.html&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>                 : &#39;./analyze/client.html&#39;,</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>             })</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>           )</span></span></code></pre><p data-v-8c9498c0>Build the app again. This time, the console should now show the path to the stats file:</p><pre data-v-8c9498c0><code data-v-8c9498c0>Webpack Bundle Analyzer saved report to /.../.next/analyze/client.html\nWebpack Bundle Analyzer saved stats file to /.../.next/stats.json\n</code></pre><h3 id=\"exploring-the-stats-file\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#exploring-the-stats-file\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Exploring the stats file</h3><p data-v-8c9498c0>The stats file is a JSON file that contains a lot of information about the build process. Fortunately, the webpack project provides the <a href=\"https://webpack.github.io/analyse/\" data-v-8c9498c0><strong data-v-8c9498c0>analyze</strong></a> tool to help us explore it.</p><p data-v-8c9498c0>When you open the stats file in the analyze tool, and click on the <strong data-v-8c9498c0>Modules</strong> tab.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/analyze-home.jpeg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>You will see module graph, and a table of modules.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/analyze-modules.jpeg\" alt=\"\" data-v-8c9498c0></p><h3 id=\"finding-the-culprit\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#finding-the-culprit\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Finding the culprit</h3><p data-v-8c9498c0>Search for the module you want to find. In this case, we are looking for <code data-v-8c9498c0>cheerio</code>. Once you find it, click on the module ID to inspect it. Also take note of the ID, it will become useful later (in this case, 848).</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/analyze-find.jpeg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>The module graph will update to highlight the selected module.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/analyze-mod.jpeg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>Scroll your mouse wheel to zoom in and out.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/analyze-mod-graph.jpeg\" alt=\"\" data-v-8c9498c0></p><ul data-v-8c9498c0><li data-v-8c9498c0>The module being inspected is highlighted in <strong data-v-8c9498c0>black</strong>.</li><li data-v-8c9498c0>The modules that depend on the module (‘reasons’) are highlighted in <strong data-v-8c9498c0>red</strong>.</li><li data-v-8c9498c0>The dependencies of the module are highlighted in <strong data-v-8c9498c0>green</strong>.</li></ul><p data-v-8c9498c0>The same information can be seen below the graph in the <strong data-v-8c9498c0>reasons</strong> and <strong data-v-8c9498c0>dependencies</strong> sections.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/analyze-mod-table.jpeg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0><strong data-v-8c9498c0>Keep following the reasons</strong> until you find the culprit in your code.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2022/12/13/analyze-trail.jpeg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>In our case,</p><ul data-v-8c9498c0><li data-v-8c9498c0>We have a module <code data-v-8c9498c0>./src/utils/Helper.ts</code> which is a collection of helper functions.</li><li data-v-8c9498c0>One of the helper function imports <code data-v-8c9498c0>juice</code>, which imports <code data-v-8c9498c0>cheerio</code>, which imports <code data-v-8c9498c0>htmlparser2</code>. This helper function is only used in the server-side code.</li><li data-v-8c9498c0>However, many client-side modules also imports <code data-v-8c9498c0>./src/utils/Helper.ts</code>, which caused juice, along with its dependencies, to be included in the client-side bundle.</li></ul><p data-v-8c9498c0>So the solution to optimize the bundle size in this scenario is to separate the <code data-v-8c9498c0>Helpers</code> module into two, one for the server and one for the client.</p>", 43)
function render(_ctx, _cache) {
  return _hoisted_1
}
__sfc__.render = render
__sfc__.__scopeId = "data-v-8c9498c0"
__sfc__.__file = "Note.vue"
exports. default = __sfc__};
window.precompiledFrontMatter = {"public":true,"title":"Analyzing and optimizing Next.js bundle size"};
</script>
  </body>
</html>

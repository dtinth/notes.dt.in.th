<!DOCTYPE html>
<html data-precompiled=true lang="en" data-dtinth="true">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/icon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advent of Code 2021: Day 24 | notes.dt.in.th</title><meta property="og:title" content="Advent of Code 2021: Day 24" data-source="note">
<meta property="og:image" content="https://screenshot.source.in.th/image/_/notes/AdventOfCode2021Day24" data-source="note">
<meta property="og:image:width" content="1800" data-source="note">
<meta property="og:image:height" content="1680" data-source="note">
<link rel="canonical" href="https://notes.dt.in.th/AdventOfCode2021Day24" data-source="note"><style id="note-styles">/* layer: default */
.me[data-v-8c9498c0]{margin-inline-end:1rem;}</style>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"
      integrity="sha256-dY2Ug42wyv3rl+sLVKEg3jbPs8f+hi7tmJ836AxVDwI="
      crossorigin="anonymous"
    ></script>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/blurhash-image@1.0.1/blurhash-image.min.js"
      integrity="sha256-qrUUgTGk7xA7iVCwraHNQjwy2JryA0K4L3DL4qidagQ="
      crossorigin="anonymous"
    ></script>
    <script type="module" crossorigin src="/runtime/index.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/supabase-CjkNZD6A.js">
    <link rel="stylesheet" crossorigin href="/runtime/index.css">
  </head>
  <body class="bg-#252423 text-#e9e8e7 antialiased">
    <header class="h-[58px] bg-#090807 border-b border-#454443 z-20 flex">
      <div class="flex items-center pl-[18px] flex-none">
        <a
          class="flex items-center text-#8b8685 hover:text-#ffffbb text-lg"
          href="/"
          >notes.dt.in.th</a
        >
      </div>
      <div
        class="flex-1 flex items-center text-#8b8685 [&_a:hover]:text-#ffffbb overflow-hidden"
        id="headerMiddle"
      >
        <div class="px-2 flex-none">›</div><div class="truncate"><a title="Ruby (topic)" href="Ruby">Ruby</a></div><div class="px-2 flex-none">›</div><div class="truncate"><a title="Advent of Code (topic)" href="AdventOfCode">Advent of Code</a></div>
      </div>
      <div
        class="flex items-center px-[18px] flex-none gap-4"
        id="headerToolbar"
      ></div>
    </header>
    <div class="h-entry">
      <main class="bg-#353433" id="main">
        <div class="notes-layout-container mx-auto p-6 py-12" id="mainContents">
          <div class="prose e-content" id="noteContents"><!--[--><h1 id="advent-of-code-2021-day-24" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#advent-of-code-2021-day-24" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Advent of Code 2021: Day 24</h1><p data-v-8c9498c0>For this day’s <a href="AdventOfCode" data-v-8c9498c0>Advent of Code</a> puzzle, first, I converted the assembly code into an Excel spreadsheet. This helps me to analyze the code more easily.</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>instructions </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> $&lt;.</span><span style="color:#79B8FF;" data-v-8c9498c0>readlines</span><span style="color:#E1E4E8;" data-v-8c9498c0>.map(</span><span style="color:#F97583;" data-v-8c9498c0>&amp;</span><span style="color:#79B8FF;" data-v-8c9498c0>:strip</span><span style="color:#E1E4E8;" data-v-8c9498c0>).map(</span><span style="color:#F97583;" data-v-8c9498c0>&amp;</span><span style="color:#79B8FF;" data-v-8c9498c0>:split</span><span style="color:#E1E4E8;" data-v-8c9498c0>)</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>row </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> { </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;w&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;x&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;y&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;z&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>, }</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>col </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> { </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;w&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;A&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;x&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;B&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;y&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;C&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;z&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;D&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, }</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>cur_row </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#79B8FF;" data-v-8c9498c0> 3</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>grid </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> {}</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>$num_inp </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#79B8FF;" data-v-8c9498c0> 0</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>instructions.each_with_index </span><span style="color:#F97583;" data-v-8c9498c0>do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |inst, i|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    result_row </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> grid[cur_row] </span><span style="color:#F97583;" data-v-8c9498c0>&amp;&amp;</span><span style="color:#E1E4E8;" data-v-8c9498c0> grid[cur_row][inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>?</span><span style="color:#E1E4E8;" data-v-8c9498c0> cur_row </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#79B8FF;" data-v-8c9498c0> 1</span><span style="color:#E1E4E8;" data-v-8c9498c0> : cur_row</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    result_col </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> col[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]]</span></span>
<span class="line" data-v-8c9498c0></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    grid[result_row] </span><span style="color:#F97583;" data-v-8c9498c0>||=</span><span style="color:#E1E4E8;" data-v-8c9498c0> {}</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    get </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#79B8FF;" data-v-8c9498c0> -&gt;</span><span style="color:#E1E4E8;" data-v-8c9498c0> var { var </span><span style="color:#F97583;" data-v-8c9498c0>=~</span><span style="color:#9ECBFF;" data-v-8c9498c0> /</span><span style="color:#DBEDFF;" data-v-8c9498c0>-?</span><span style="color:#85E89D;font-weight:bold;" data-v-8c9498c0>\d</span><span style="color:#DBEDFF;" data-v-8c9498c0>+</span><span style="color:#9ECBFF;" data-v-8c9498c0>/</span><span style="color:#F97583;" data-v-8c9498c0> ?</span><span style="color:#E1E4E8;" data-v-8c9498c0> var : </span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{col[var]}#{row[var]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;</span><span style="color:#E1E4E8;" data-v-8c9498c0> }</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    grid[result_row][inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#F97583;" data-v-8c9498c0> begin</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        case</span><span style="color:#E1E4E8;" data-v-8c9498c0> inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;inp&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>            v </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#9ECBFF;" data-v-8c9498c0> &quot;=</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{(</span><span style="color:#79B8FF;" data-v-8c9498c0>65</span><span style="color:#F97583;" data-v-8c9498c0> +</span><span style="color:#79B8FF;" data-v-8c9498c0> 4</span><span style="color:#F97583;" data-v-8c9498c0> +</span><span style="color:#E1E4E8;" data-v-8c9498c0> $num_inp</span><span style="color:#9ECBFF;" data-v-8c9498c0>).chr}</span><span style="color:#9ECBFF;" data-v-8c9498c0>1&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>            $num_inp </span><span style="color:#F97583;" data-v-8c9498c0>+=</span><span style="color:#79B8FF;" data-v-8c9498c0> 1</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>            v</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;add&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#9ECBFF;" data-v-8c9498c0>            &quot;=</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>+</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;mul&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>            inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>] </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;0&#39;</span><span style="color:#F97583;" data-v-8c9498c0> ?</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;0&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> : </span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;=</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>*</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;div&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#9ECBFF;" data-v-8c9498c0>            &quot;=TRUNC(</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>/</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>)&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;mod&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#9ECBFF;" data-v-8c9498c0>            &quot;=MOD(</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>,</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>)&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;eql&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#9ECBFF;" data-v-8c9498c0>            &quot;=IF(</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>=</span><span style="color:#9ECBFF;" data-v-8c9498c0>#{get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#9ECBFF;" data-v-8c9498c0>]]}</span><span style="color:#9ECBFF;" data-v-8c9498c0>,1,0)&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    cur_row </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> result_row</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    row[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> cur_row</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>puts</span><span style="color:#E1E4E8;" data-v-8c9498c0> [</span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;w&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;x&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;y&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;z&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#E1E4E8;" data-v-8c9498c0>[</span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>] </span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#79B8FF;" data-v-8c9498c0> 14</span><span style="color:#E1E4E8;" data-v-8c9498c0>] </span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#9ECBFF;" data-v-8c9498c0> &quot;</span><span style="color:#79B8FF;" data-v-8c9498c0>\t</span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>puts</span><span style="color:#E1E4E8;" data-v-8c9498c0> [</span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>] </span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#9ECBFF;" data-v-8c9498c0> &quot;</span><span style="color:#79B8FF;" data-v-8c9498c0>\t</span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>(</span><span style="color:#79B8FF;" data-v-8c9498c0>3</span><span style="color:#E1E4E8;" data-v-8c9498c0>..grid.keys.max).each </span><span style="color:#F97583;" data-v-8c9498c0>do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |i|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>    puts</span><span style="color:#E1E4E8;" data-v-8c9498c0> [</span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;w&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;x&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;y&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;z&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0>].map { grid[i][_1] </span><span style="color:#F97583;" data-v-8c9498c0>||</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> } </span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#9ECBFF;" data-v-8c9498c0> &quot;</span><span style="color:#79B8FF;" data-v-8c9498c0>\t</span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>end</span></span></code></pre><p data-v-8c9498c0>The result looks like this:</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2021/12/24/excl.png" alt="Speadsheet" data-v-8c9498c0></p><p data-v-8c9498c0>Also, built an interpreter to verify that the Excel sheet works correctly:</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>$digits </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#79B8FF;" data-v-8c9498c0> 99999999999999</span><span style="color:#E1E4E8;" data-v-8c9498c0>.digits</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>variables </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> { </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;w&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;x&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;y&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#9ECBFF;" data-v-8c9498c0>&#39;z&#39;</span><span style="color:#E1E4E8;" data-v-8c9498c0> =&gt; </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>, }</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>instructions.each_with_index </span><span style="color:#F97583;" data-v-8c9498c0>do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |inst, i|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    get </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#79B8FF;" data-v-8c9498c0> -&gt;</span><span style="color:#E1E4E8;" data-v-8c9498c0> var { var </span><span style="color:#F97583;" data-v-8c9498c0>=~</span><span style="color:#9ECBFF;" data-v-8c9498c0> /</span><span style="color:#DBEDFF;" data-v-8c9498c0>-?</span><span style="color:#85E89D;font-weight:bold;" data-v-8c9498c0>\d</span><span style="color:#DBEDFF;" data-v-8c9498c0>+</span><span style="color:#9ECBFF;" data-v-8c9498c0>/</span><span style="color:#F97583;" data-v-8c9498c0> ?</span><span style="color:#E1E4E8;" data-v-8c9498c0> var.to_i : variables[var] }</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    case</span><span style="color:#E1E4E8;" data-v-8c9498c0> inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;inp&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        variables[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> $digits.pop</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;add&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        variables[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>+=</span><span style="color:#E1E4E8;" data-v-8c9498c0> get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>]]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;mul&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        variables[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>*=</span><span style="color:#E1E4E8;" data-v-8c9498c0> get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>]]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;div&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        variables[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>/=</span><span style="color:#E1E4E8;" data-v-8c9498c0> get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>]]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;mod&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        variables[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>%=</span><span style="color:#E1E4E8;" data-v-8c9498c0> get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>]]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    when</span><span style="color:#9ECBFF;" data-v-8c9498c0> &#39;eql&#39;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        variables[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> variables[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#E1E4E8;" data-v-8c9498c0> get[inst[</span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>]] </span><span style="color:#F97583;" data-v-8c9498c0>?</span><span style="color:#79B8FF;" data-v-8c9498c0> 1</span><span style="color:#E1E4E8;" data-v-8c9498c0> : </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>p</span><span style="color:#E1E4E8;" data-v-8c9498c0> variables</span></span></code></pre><p data-v-8c9498c0>After analyzing the Excel sheet, I recreated the program in higher-level <a href="Ruby" data-v-8c9498c0>Ruby</a>:</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>add </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> [</span><span style="color:#79B8FF;" data-v-8c9498c0>13</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>15</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>15</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>11</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#79B8FF;" data-v-8c9498c0>16</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#79B8FF;" data-v-8c9498c0>11</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#79B8FF;" data-v-8c9498c0>6</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>11</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>10</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#79B8FF;" data-v-8c9498c0>10</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#79B8FF;" data-v-8c9498c0>8</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#79B8FF;" data-v-8c9498c0>11</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>12</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#79B8FF;" data-v-8c9498c0>15</span><span style="color:#E1E4E8;" data-v-8c9498c0>]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>add2 </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> [</span><span style="color:#79B8FF;" data-v-8c9498c0>5</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>14</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>15</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>16</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>8</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>2</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>13</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>16</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>6</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>6</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>11</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>5</span><span style="color:#E1E4E8;" data-v-8c9498c0>]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>div </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0>  [</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>inp </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0>  [</span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>,   </span><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>w </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> x </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> y </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> z </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#79B8FF;" data-v-8c9498c0> 0</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>inp.zip(add, add2, div).each </span><span style="color:#F97583;" data-v-8c9498c0>do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |w, a, a2, d|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    x </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> (z </span><span style="color:#F97583;" data-v-8c9498c0>%</span><span style="color:#79B8FF;" data-v-8c9498c0> 26</span><span style="color:#E1E4E8;" data-v-8c9498c0>) </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#E1E4E8;" data-v-8c9498c0> a </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#E1E4E8;" data-v-8c9498c0> w </span><span style="color:#F97583;" data-v-8c9498c0>?</span><span style="color:#79B8FF;" data-v-8c9498c0> 0</span><span style="color:#E1E4E8;" data-v-8c9498c0> : </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    y </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#79B8FF;" data-v-8c9498c0> 25</span><span style="color:#F97583;" data-v-8c9498c0> *</span><span style="color:#E1E4E8;" data-v-8c9498c0> x </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#79B8FF;" data-v-8c9498c0> 1</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    z </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> y </span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#E1E4E8;" data-v-8c9498c0> (z </span><span style="color:#F97583;" data-v-8c9498c0>/</span><span style="color:#E1E4E8;" data-v-8c9498c0> d)</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    y </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> (w </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#E1E4E8;" data-v-8c9498c0> a2) </span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#E1E4E8;" data-v-8c9498c0> x</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    z </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> z </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#E1E4E8;" data-v-8c9498c0> y</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>    p</span><span style="color:#E1E4E8;" data-v-8c9498c0> [w, x, y, z]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>end</span></span></code></pre><p data-v-8c9498c0>I noticed that there is a lot of no-op when <code data-v-8c9498c0>x == 0</code>, so I factored them into 2 cases:</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>inp.zip(add, add2, div).each </span><span style="color:#F97583;" data-v-8c9498c0>do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |w, a, a2, d|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    if</span><span style="color:#E1E4E8;" data-v-8c9498c0> w </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#E1E4E8;" data-v-8c9498c0> (z </span><span style="color:#F97583;" data-v-8c9498c0>%</span><span style="color:#79B8FF;" data-v-8c9498c0> 26</span><span style="color:#E1E4E8;" data-v-8c9498c0>) </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#E1E4E8;" data-v-8c9498c0> a</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        z </span><span style="color:#F97583;" data-v-8c9498c0>/=</span><span style="color:#E1E4E8;" data-v-8c9498c0> d</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    else</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        z </span><span style="color:#F97583;" data-v-8c9498c0>/=</span><span style="color:#E1E4E8;" data-v-8c9498c0> d</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        z </span><span style="color:#F97583;" data-v-8c9498c0>*=</span><span style="color:#79B8FF;" data-v-8c9498c0> 26</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        z </span><span style="color:#F97583;" data-v-8c9498c0>+=</span><span style="color:#E1E4E8;" data-v-8c9498c0> w </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#E1E4E8;" data-v-8c9498c0> a2</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>    p</span><span style="color:#E1E4E8;" data-v-8c9498c0> [w, x, y, z]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>end</span></span></code></pre><p data-v-8c9498c0>Notice the recurrence of number 26 in the code. Also, the values of <code data-v-8c9498c0>div</code> and thus the variable <code data-v-8c9498c0>d</code> only hold number <code data-v-8c9498c0>1</code> and <code data-v-8c9498c0>26</code>. This looks like a stack of base-26 digits:</p><ul data-v-8c9498c0><li data-v-8c9498c0><code data-v-8c9498c0>z /= 1</code> → no-op</li><li data-v-8c9498c0><code data-v-8c9498c0>z /= 26</code> → pop</li><li data-v-8c9498c0><code data-v-8c9498c0>z *= 26; z += _</code> → push</li></ul><p data-v-8c9498c0>Rewritten using array-based stack:</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>zz </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> []</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>inp.zip(add, add2, div).each </span><span style="color:#F97583;" data-v-8c9498c0>do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |w, a, a2, d|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    if</span><span style="color:#E1E4E8;" data-v-8c9498c0> zz.last </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#E1E4E8;" data-v-8c9498c0> w </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#E1E4E8;" data-v-8c9498c0> a</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        zz.pop </span><span style="color:#F97583;" data-v-8c9498c0>if</span><span style="color:#E1E4E8;" data-v-8c9498c0> d </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#79B8FF;" data-v-8c9498c0> 26</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    else</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        zz.pop </span><span style="color:#F97583;" data-v-8c9498c0>if</span><span style="color:#E1E4E8;" data-v-8c9498c0> d </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#79B8FF;" data-v-8c9498c0> 26</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        zz.push w </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#E1E4E8;" data-v-8c9498c0> a2</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>    p</span><span style="color:#E1E4E8;" data-v-8c9498c0> [w, zz.reduce(</span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>) { _1 </span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#79B8FF;" data-v-8c9498c0> 26</span><span style="color:#F97583;" data-v-8c9498c0> +</span><span style="color:#E1E4E8;" data-v-8c9498c0> _2 }, zz]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>end</span></span></code></pre><p data-v-8c9498c0>Take a look again at the <code data-v-8c9498c0>div</code> array,</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>div </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0>  [</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>, </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>,  </span><span style="color:#79B8FF;" data-v-8c9498c0>26</span><span style="color:#E1E4E8;" data-v-8c9498c0>]</span></span></code></pre><p data-v-8c9498c0>There is an equal number of <code data-v-8c9498c0>1</code> (push) and <code data-v-8c9498c0>26</code> (pop) in the array. That means if we fail to pop the stack when <code data-v-8c9498c0>d == 26</code>, in the end, the stack will not be empty (0). In such cases there will be no solution, so we can prune the search space.</p><p data-v-8c9498c0>With this knowledge, the problem has turned into state-space search. The rest, is just a matter of brute-forcing.</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>find </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#79B8FF;" data-v-8c9498c0> -&gt;</span><span style="color:#E1E4E8;" data-v-8c9498c0> w, i, zz, path {</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    if</span><span style="color:#E1E4E8;" data-v-8c9498c0> i </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#79B8FF;" data-v-8c9498c0> 14</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>        p</span><span style="color:#E1E4E8;" data-v-8c9498c0> [zz, path.join[</span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>...</span><span style="color:#79B8FF;" data-v-8c9498c0>14</span><span style="color:#E1E4E8;" data-v-8c9498c0>]]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        return</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    a </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> add[i]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    a2 </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> add2[i]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    d </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> div[i]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    if</span><span style="color:#E1E4E8;" data-v-8c9498c0> d </span><span style="color:#F97583;" data-v-8c9498c0>==</span><span style="color:#79B8FF;" data-v-8c9498c0> 26</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        return</span><span style="color:#F97583;" data-v-8c9498c0> if</span><span style="color:#E1E4E8;" data-v-8c9498c0> w </span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#E1E4E8;" data-v-8c9498c0> a </span><span style="color:#F97583;" data-v-8c9498c0>!=</span><span style="color:#E1E4E8;" data-v-8c9498c0> zz.last</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        next_zz </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> zz[</span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>...</span><span style="color:#F97583;" data-v-8c9498c0>-</span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#E1E4E8;" data-v-8c9498c0>]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>        9</span><span style="color:#E1E4E8;" data-v-8c9498c0>.downto </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#F97583;" data-v-8c9498c0> do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |next_w|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>            find[next_w, i </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#79B8FF;" data-v-8c9498c0> 1</span><span style="color:#E1E4E8;" data-v-8c9498c0>, next_zz, [</span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#E1E4E8;" data-v-8c9498c0>path, next_w]]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    else</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        next_zz </span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0> [</span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#E1E4E8;" data-v-8c9498c0>zz, w </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#E1E4E8;" data-v-8c9498c0> a2]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>        9</span><span style="color:#E1E4E8;" data-v-8c9498c0>.downto </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#F97583;" data-v-8c9498c0> do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |next_w|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>            find[next_w, i </span><span style="color:#F97583;" data-v-8c9498c0>+</span><span style="color:#79B8FF;" data-v-8c9498c0> 1</span><span style="color:#E1E4E8;" data-v-8c9498c0>, next_zz, [</span><span style="color:#F97583;" data-v-8c9498c0>*</span><span style="color:#E1E4E8;" data-v-8c9498c0>path, next_w]]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>        end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>}</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>9</span><span style="color:#E1E4E8;" data-v-8c9498c0>.downto </span><span style="color:#79B8FF;" data-v-8c9498c0>1</span><span style="color:#F97583;" data-v-8c9498c0> do</span><span style="color:#E1E4E8;" data-v-8c9498c0> |w|</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    find[w, </span><span style="color:#79B8FF;" data-v-8c9498c0>0</span><span style="color:#E1E4E8;" data-v-8c9498c0>, [], [w]]</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>end</span></span>
<span class="line" data-v-8c9498c0><span style="color:#79B8FF;" data-v-8c9498c0>p</span><span style="color:#79B8FF;" data-v-8c9498c0> :done</span></span></code></pre><!--]--></div>
        </div>
      </main>
      <footer>
        <div
          class="notes-layout-container mx-auto py-4 px-6 text-#8b8685 text-right text-sm"
          id="footerContents"
        >
          <notes-page-footer></notes-page-footer>
        </div>
      </footer>
    </div>
    <script>
window.precompiledNoteBehavior = function(require, exports, module, Vue) {"use strict";Object.defineProperty(exports, "__esModule", {value: true});const __sfc__ = {};
var _vue = require('vue');

const _withScopeId = n => (_vue.pushScopeId.call(void 0, "data-v-8c9498c0"),n=n(),_vue.popScopeId.call(void 0, ),n)
const _hoisted_1 = /*#__PURE__*/_vue.createStaticVNode.call(void 0, "<h1 id=\"advent-of-code-2021-day-24\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#advent-of-code-2021-day-24\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Advent of Code 2021: Day 24</h1><p data-v-8c9498c0>For this day’s <a href=\"AdventOfCode\" data-v-8c9498c0>Advent of Code</a> puzzle, first, I converted the assembly code into an Excel spreadsheet. This helps me to analyze the code more easily.</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>instructions </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> $&lt;.</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>readlines</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>.map(</span><span style=\"color:#F97583;\" data-v-8c9498c0>&amp;</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>:strip</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>).map(</span><span style=\"color:#F97583;\" data-v-8c9498c0>&amp;</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>:split</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>)</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>row </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> { </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;w&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;x&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;y&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;z&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, }</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>col </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> { </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;w&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;A&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;x&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;B&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;y&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;C&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;z&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;D&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, }</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>cur_row </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 3</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>grid </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> {}</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>$num_inp </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 0</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>instructions.each_with_index </span><span style=\"color:#F97583;\" data-v-8c9498c0>do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |inst, i|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    result_row </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> grid[cur_row] </span><span style=\"color:#F97583;\" data-v-8c9498c0>&amp;&amp;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> grid[cur_row][inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>?</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> cur_row </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> : cur_row</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    result_col </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> col[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]]</span></span>\n<span class=\"line\" data-v-8c9498c0></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    grid[result_row] </span><span style=\"color:#F97583;\" data-v-8c9498c0>||=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> {}</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    get </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> -&gt;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> var { var </span><span style=\"color:#F97583;\" data-v-8c9498c0>=~</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> /</span><span style=\"color:#DBEDFF;\" data-v-8c9498c0>-?</span><span style=\"color:#85E89D;font-weight:bold;\" data-v-8c9498c0>\\d</span><span style=\"color:#DBEDFF;\" data-v-8c9498c0>+</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>/</span><span style=\"color:#F97583;\" data-v-8c9498c0> ?</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> var : </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{col[var]}#{row[var]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> }</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    grid[result_row][inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#F97583;\" data-v-8c9498c0> begin</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        case</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;inp&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>            v </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &quot;=</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{(</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>65</span><span style=\"color:#F97583;\" data-v-8c9498c0> +</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 4</span><span style=\"color:#F97583;\" data-v-8c9498c0> +</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> $num_inp</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>).chr}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>1&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>            $num_inp </span><span style=\"color:#F97583;\" data-v-8c9498c0>+=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 1</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>            v</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;add&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#9ECBFF;\" data-v-8c9498c0>            &quot;=</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>+</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;mul&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>            inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>] </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;0&#39;</span><span style=\"color:#F97583;\" data-v-8c9498c0> ?</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;0&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> : </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;=</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>*</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;div&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#9ECBFF;\" data-v-8c9498c0>            &quot;=TRUNC(</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>/</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>)&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;mod&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#9ECBFF;\" data-v-8c9498c0>            &quot;=MOD(</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>,</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>)&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;eql&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#9ECBFF;\" data-v-8c9498c0>            &quot;=IF(</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>=</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>#{get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>]]}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>,1,0)&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    cur_row </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> result_row</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    row[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> cur_row</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>puts</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;w&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;x&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;y&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;z&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>] </span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 14</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>] </span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &quot;</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>\\t</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>puts</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>] </span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &quot;</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>\\t</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>(</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>3</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>..grid.keys.max).each </span><span style=\"color:#F97583;\" data-v-8c9498c0>do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |i|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>    puts</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;w&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;x&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;y&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;z&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>].map { grid[i][_1] </span><span style=\"color:#F97583;\" data-v-8c9498c0>||</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> } </span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &quot;</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>\\t</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>end</span></span></code></pre><p data-v-8c9498c0>The result looks like this:</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2021/12/24/excl.png\" alt=\"Speadsheet\" data-v-8c9498c0></p><p data-v-8c9498c0>Also, built an interpreter to verify that the Excel sheet works correctly:</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>$digits </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 99999999999999</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>.digits</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>variables </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> { </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;w&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;x&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;y&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&#39;z&#39;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> =&gt; </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, }</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>instructions.each_with_index </span><span style=\"color:#F97583;\" data-v-8c9498c0>do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |inst, i|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    get </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> -&gt;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> var { var </span><span style=\"color:#F97583;\" data-v-8c9498c0>=~</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> /</span><span style=\"color:#DBEDFF;\" data-v-8c9498c0>-?</span><span style=\"color:#85E89D;font-weight:bold;\" data-v-8c9498c0>\\d</span><span style=\"color:#DBEDFF;\" data-v-8c9498c0>+</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>/</span><span style=\"color:#F97583;\" data-v-8c9498c0> ?</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> var.to_i : variables[var] }</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    case</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;inp&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        variables[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> $digits.pop</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;add&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        variables[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>+=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;mul&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        variables[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>*=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;div&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        variables[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>/=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;mod&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        variables[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>%=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    when</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> &#39;eql&#39;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        variables[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> variables[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> get[inst[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]] </span><span style=\"color:#F97583;\" data-v-8c9498c0>?</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> : </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>p</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> variables</span></span></code></pre><p data-v-8c9498c0>After analyzing the Excel sheet, I recreated the program in higher-level <a href=\"Ruby\" data-v-8c9498c0>Ruby</a>:</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>add </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>13</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>15</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>15</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>11</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>16</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>11</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>6</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>11</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>10</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>10</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>8</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>11</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>12</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>15</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>add2 </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>5</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>14</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>15</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>16</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>8</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>2</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>13</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>16</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>6</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>6</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>11</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>5</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>div </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>  [</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>inp </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>  [</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,   </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>w </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> x </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> y </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> z </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 0</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>inp.zip(add, add2, div).each </span><span style=\"color:#F97583;\" data-v-8c9498c0>do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |w, a, a2, d|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    x </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> (z </span><span style=\"color:#F97583;\" data-v-8c9498c0>%</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>) </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> a </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> w </span><span style=\"color:#F97583;\" data-v-8c9498c0>?</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> : </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    y </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 25</span><span style=\"color:#F97583;\" data-v-8c9498c0> *</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> x </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 1</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    z </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> y </span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> (z </span><span style=\"color:#F97583;\" data-v-8c9498c0>/</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> d)</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    y </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> (w </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> a2) </span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> x</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    z </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> z </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> y</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>    p</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [w, x, y, z]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>end</span></span></code></pre><p data-v-8c9498c0>I noticed that there is a lot of no-op when <code data-v-8c9498c0>x == 0</code>, so I factored them into 2 cases:</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>inp.zip(add, add2, div).each </span><span style=\"color:#F97583;\" data-v-8c9498c0>do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |w, a, a2, d|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    if</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> w </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> (z </span><span style=\"color:#F97583;\" data-v-8c9498c0>%</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>) </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> a</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        z </span><span style=\"color:#F97583;\" data-v-8c9498c0>/=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> d</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    else</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        z </span><span style=\"color:#F97583;\" data-v-8c9498c0>/=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> d</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        z </span><span style=\"color:#F97583;\" data-v-8c9498c0>*=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 26</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        z </span><span style=\"color:#F97583;\" data-v-8c9498c0>+=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> w </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> a2</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>    p</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [w, x, y, z]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>end</span></span></code></pre><p data-v-8c9498c0>Notice the recurrence of number 26 in the code. Also, the values of <code data-v-8c9498c0>div</code> and thus the variable <code data-v-8c9498c0>d</code> only hold number <code data-v-8c9498c0>1</code> and <code data-v-8c9498c0>26</code>. This looks like a stack of base-26 digits:</p><ul data-v-8c9498c0><li data-v-8c9498c0><code data-v-8c9498c0>z /= 1</code> → no-op</li><li data-v-8c9498c0><code data-v-8c9498c0>z /= 26</code> → pop</li><li data-v-8c9498c0><code data-v-8c9498c0>z *= 26; z += _</code> → push</li></ul><p data-v-8c9498c0>Rewritten using array-based stack:</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>zz </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> []</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>inp.zip(add, add2, div).each </span><span style=\"color:#F97583;\" data-v-8c9498c0>do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |w, a, a2, d|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    if</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> zz.last </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> w </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> a</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        zz.pop </span><span style=\"color:#F97583;\" data-v-8c9498c0>if</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> d </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 26</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    else</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        zz.pop </span><span style=\"color:#F97583;\" data-v-8c9498c0>if</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> d </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 26</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        zz.push w </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> a2</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>    p</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [w, zz.reduce(</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>) { _1 </span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 26</span><span style=\"color:#F97583;\" data-v-8c9498c0> +</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> _2 }, zz]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>end</span></span></code></pre><p data-v-8c9498c0>Take a look again at the <code data-v-8c9498c0>div</code> array,</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>div </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>  [</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>,  </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>26</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]</span></span></code></pre><p data-v-8c9498c0>There is an equal number of <code data-v-8c9498c0>1</code> (push) and <code data-v-8c9498c0>26</code> (pop) in the array. That means if we fail to pop the stack when <code data-v-8c9498c0>d == 26</code>, in the end, the stack will not be empty (0). In such cases there will be no solution, so we can prune the search space.</p><p data-v-8c9498c0>With this knowledge, the problem has turned into state-space search. The rest, is just a matter of brute-forcing.</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>find </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> -&gt;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> w, i, zz, path {</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    if</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> i </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 14</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>        p</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [zz, path.join[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>...</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>14</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        return</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    a </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> add[i]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    a2 </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> add2[i]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    d </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> div[i]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    if</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> d </span><span style=\"color:#F97583;\" data-v-8c9498c0>==</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 26</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        return</span><span style=\"color:#F97583;\" data-v-8c9498c0> if</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> w </span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> a </span><span style=\"color:#F97583;\" data-v-8c9498c0>!=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> zz.last</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        next_zz </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> zz[</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>...</span><span style=\"color:#F97583;\" data-v-8c9498c0>-</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>        9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>.downto </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#F97583;\" data-v-8c9498c0> do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |next_w|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>            find[next_w, i </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, next_zz, [</span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>path, next_w]]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    else</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        next_zz </span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> [</span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>zz, w </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> a2]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>        9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>.downto </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#F97583;\" data-v-8c9498c0> do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |next_w|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>            find[next_w, i </span><span style=\"color:#F97583;\" data-v-8c9498c0>+</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> 1</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, next_zz, [</span><span style=\"color:#F97583;\" data-v-8c9498c0>*</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>path, next_w]]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>        end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>}</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>9</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>.downto </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>1</span><span style=\"color:#F97583;\" data-v-8c9498c0> do</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> |w|</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    find[w, </span><span style=\"color:#79B8FF;\" data-v-8c9498c0>0</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>, [], [w]]</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>end</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#79B8FF;\" data-v-8c9498c0>p</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> :done</span></span></code></pre>", 20)
function render(_ctx, _cache) {
  return _hoisted_1
}
__sfc__.render = render
__sfc__.__scopeId = "data-v-8c9498c0"
__sfc__.__file = "Note.vue"
exports. default = __sfc__};
window.precompiledFrontMatter = {"public":true,"title":"Advent of Code 2021: Day 24","aliases":["20211224T121217Z7595"]};
</script>
  </body>
</html>

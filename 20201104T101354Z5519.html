<!DOCTYPE html>
<html data-precompiled=true lang="en" data-dtinth="true">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/icon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>On state management tools in React | notes.dt.in.th</title><meta property="og:title" content="On state management tools in React" data-source="note">
<meta property="og:image" content="https://screenshot.source.in.th/image/_/notes/20201104T101354Z5519" data-source="note">
<meta property="og:image:width" content="1800" data-source="note">
<meta property="og:image:height" content="1680" data-source="note">
<link rel="canonical" href="https://notes.dt.in.th/20201104T101354Z5519" data-source="note"><style id="note-styles">/* layer: shortcuts */
.container[data-v-8c9498c0]{width:100%;}
@media (min-width: 640px){
.container[data-v-8c9498c0]{max-width:640px;}
}
@media (min-width: 768px){
.container[data-v-8c9498c0]{max-width:768px;}
}
@media (min-width: 1024px){
.container[data-v-8c9498c0]{max-width:1024px;}
}
@media (min-width: 1280px){
.container[data-v-8c9498c0]{max-width:1280px;}
}
@media (min-width: 1536px){
.container[data-v-8c9498c0]{max-width:1536px;}
}
/* layer: default */
.my[data-v-8c9498c0]{margin-top:1rem;margin-bottom:1rem;}
.me[data-v-8c9498c0]{margin-inline-end:1rem;}</style>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"
      integrity="sha256-dY2Ug42wyv3rl+sLVKEg3jbPs8f+hi7tmJ836AxVDwI="
      crossorigin="anonymous"
    ></script>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/blurhash-image@1.0.1/blurhash-image.min.js"
      integrity="sha256-qrUUgTGk7xA7iVCwraHNQjwy2JryA0K4L3DL4qidagQ="
      crossorigin="anonymous"
    ></script>
    <script type="module" crossorigin src="/runtime/index.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/supabase-CjkNZD6A.js">
    <link rel="stylesheet" crossorigin href="/runtime/index.css">
  </head>
  <body class="bg-#252423 text-#e9e8e7 antialiased">
    <header class="h-[58px] bg-#090807 border-b border-#454443 z-20 flex">
      <div class="flex items-center pl-[18px] flex-none">
        <a
          class="flex items-center text-#8b8685 hover:text-#ffffbb text-lg"
          href="/"
          >notes.dt.in.th</a
        >
      </div>
      <div
        class="flex-1 flex items-center text-#8b8685 [&_a:hover]:text-#ffffbb overflow-hidden"
        id="headerMiddle"
      >
        <div class="px-2 flex-none">›</div><div class="truncate"><a title="Cloud Platform (topic)" href="CloudPlatform">Cloud Platform</a></div><div class="px-2 flex-none">›</div><div class="truncate"><a title="Vercel (topic)" href="Vercel">Vercel</a></div><div class="px-2 flex-none">›</div><div class="truncate"><a title="Next.js (topic)" href="Next">Next.js</a></div><div class="px-2 flex-none">›</div><div class="truncate"><a title="React (topic)" href="React">React</a></div>
      </div>
      <div
        class="flex items-center px-[18px] flex-none gap-4"
        id="headerToolbar"
      ></div>
    </header>
    <div class="h-entry">
      <main class="bg-#353433" id="main">
        <div class="notes-layout-container mx-auto p-6 py-12" id="mainContents">
          <div class="prose e-content" id="noteContents"><!--[--><p data-v-8c9498c0>It’s 2020 but I still see questions everywhere about <em data-v-8c9498c0>“Which state management solutions should I use?”</em> in <a href="React" data-v-8c9498c0>React</a>.</p><ul data-v-8c9498c0><li data-v-8c9498c0>Should I use <a href="https://redux.js.org/" title="Redux - A predictable state container for JavaScript apps" data-v-8c9498c0>Redux</a>? Oh, <a href="https://medium.com/@dan_abramov/you-might-not-need-redux-be46360cf367" title="You Might Not Need Redux." data-v-8c9498c0>I might not need it</a>?</li><li data-v-8c9498c0>What then? Is <a href="https://reactjs.org/docs/faq-state.html#should-i-use-a-state-management-library-like-redux-or-mobx" title="Component State – React" data-v-8c9498c0>local state</a> enough or do I need <a href="https://reactjs.org/docs/context.html" title="Context – React" data-v-8c9498c0>React Context</a>?</li><li data-v-8c9498c0>How about <a href="https://github.com/mobxjs/mobx" title="GitHub - mobxjs/mobx: Simple, scalable state management." data-v-8c9498c0>MobX</a> (<a href="https://github.com/mobxjs/mobx-state-tree" title="GitHub - mobxjs/mobx-state-tree" data-v-8c9498c0>mobx-state-tree</a>?), <a href="https://recoiljs.org/" title="Recoil" data-v-8c9498c0>Recoil</a>, <a href="https://github.com/storeon/storeon" title="GitHub - storeon/storeon" data-v-8c9498c0>Storeon</a>, <a href="https://github.com/pmndrs/zustand" title="GitHub - pmndrs/zustand" data-v-8c9498c0>Zustand</a>?</li><li data-v-8c9498c0>Or should I embrace streams/observable and use <a href="https://rxjs.dev/" title="RxJS" data-v-8c9498c0>RxJS</a>?</li><li data-v-8c9498c0>If my backend is GraphQL, should I use dedicated clients like <a href="https://github.com/apollographql/apollo-client" title="GitHub - apollographql/apollo-client" data-v-8c9498c0>Apollo Client</a> or the ones above would be enough?</li><li data-v-8c9498c0>There’s also a new trend on <a href="https://epicreact.dev/my-state-management-mistake/" title="My State Management Mistake | Epic React by Kent C. Dodds" data-v-8c9498c0>“data-fetching libraries” which is higher-level than state-management libraries</a> but still backend agnostic. Or should I just use <a href="https://react-query.tanstack.com/" title="React Query - Hooks for fetching, caching and updating ..." data-v-8c9498c0>React Query</a> or <a href="https://github.com/vercel/swr" title="GitHub - vercel/swr: React Hooks library for remote data ..." data-v-8c9498c0>SWR</a>?</li></ul><p data-v-8c9498c0>After 5 years of experience with React, my opinion is now summed up in this picture (click to view full size):</p><p data-v-8c9498c0><a href="https://static.dt.in.th/uploads/2020/11/04/abstract-away-state-management.svg" data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2020/11/04/abstract-away-state-management.svg" alt="" data-v-8c9498c0></a></p><p data-v-8c9498c0>Instead of seeking the perfect state management solutions for your use case, remember that as a project grows, its use cases tends to changes, seek to learn how to build well-factored software. The <a href="https://programmingisterrible.com/" title="programming is terrible" data-v-8c9498c0>programming is terrible</a> blog, <a href="https://architectelevator.com/" title="The Transformation Architect - The Architect Elevator" data-v-8c9498c0>The Architect Elevator</a> website, and <a href="https://martinfowler.com/" title="martinfowler.com - A website on building software effectively" data-v-8c9498c0>Martin Fowler</a>’s website are filled with great advice. Then all the solutions out there will become tools that can be wielded <em data-v-8c9498c0>effectively</em>.</p><h2 id="why-do-i-recommend-this" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#why-do-i-recommend-this" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Why do I recommend this?</h2><p data-v-8c9498c0>I have observed that a single piece of data will be reused in multiple views. Let’s consider a chat application where you can mark certain chats as pinned.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-1.svg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>Before <a href="https://react-query.tanstack.com/" title="React Query - Hooks for fetching, caching and updating ..." data-v-8c9498c0>React Query</a> existed, I might use <a href="https://redux.js.org/" title="Redux - A predictable state container for JavaScript apps" data-v-8c9498c0>Redux</a> to do this. So naturally, each view component would use <a href="https://react-redux.js.org/api/hooks#useselector" title="Hooks | React Redux" data-v-8c9498c0>useSelector</a> and <a href="https://react-redux.js.org/api/hooks#usedispatch" title="Hooks | React Redux" data-v-8c9498c0>useDispatch</a>.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-2.svg" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>Fast forward to 2020, and now <a href="https://react-query.tanstack.com/" title="React Query - Hooks for fetching, caching and updating ..." data-v-8c9498c0>React Query</a> is a thing. Now I am envy of all the greenfield apps that gets to use it.</p><p data-v-8c9498c0>Looking back, the original implementation we have its full of boilerplate and is bug-ridden. Sometimes the state would not synchronize correctly due to me forgetting to put <code data-v-8c9498c0>useEffect</code> in some places. The buggy code is then copy-and-pasted all over the place.</p><p data-v-8c9498c0>And so, it seems more effective to just switch to React Query. In this case I would use the <a href="https://react-query.tanstack.com/docs/guides/queries" title="Guides &amp; Concepts: Queries | React Query | TanStack" data-v-8c9498c0>useQuery</a> and <a href="https://react-query.tanstack.com/docs/guides/mutations" title="Guides &amp; Concepts: Mutations | React Query | TanStack" data-v-8c9498c0>useMutation</a> hooks instead. But then I would need to change several components. This is a laborious and boring task.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-3.svg" alt="" data-v-8c9498c0></p><h3 id="in-an-alternative-universe" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#in-an-alternative-universe" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>In an alternative universe…</h3><p data-v-8c9498c0>Now, what if, back at that time, I decided that <em data-v-8c9498c0>“UI components should not be aware of what state management solution is being used”</em>?</p><p data-v-8c9498c0>Then after the initial implementation using Redux, I would spend a few minutes <a href="https://codesqueeze.com/the-art-of-harvesting-abstraction/" title="The Art of Harvesting Abstraction" data-v-8c9498c0>harvesting</a> the data-binding code and refactor it into a custom hook.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-4.svg" alt="" data-v-8c9498c0></p><blockquote data-v-8c9498c0><p data-v-8c9498c0>In the end, what defines a module is what pieces of the system it will never responsible for, rather what it is currently responsible for.</p><p data-v-8c9498c0><cite data-v-8c9498c0>— <a href="https://programmingisterrible.com/post/176657481103/repeat-yourself-do-more-than-one-thing-and" title="Repeat yourself, do more than one thing, and rewrite ..." data-v-8c9498c0>Tef, “Repeat yourself, do more than one thing, and rewrite everything”, programming is terrible</a></cite></p></blockquote><p data-v-8c9498c0>2020 comes and React Query becomes popular. In this alternate reality, the work required of me was much fourfold smaller. The UI components can be blissfully ignorant that behind their backs, the state management solution has been replaced.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-5.svg" alt="" data-v-8c9498c0></p><h2 id="decoupling-ui-from-state-management" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#decoupling-ui-from-state-management" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Decoupling UI from state management</h2><p data-v-8c9498c0>Multiple techniques exist:</p><ul data-v-8c9498c0><li data-v-8c9498c0><p data-v-8c9498c0><a href="https://reactjs.org/docs/hooks-intro.html" title="Introducing Hooks – React" data-v-8c9498c0><strong data-v-8c9498c0>Hooks</strong></a> are generally the cleanest solution</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>const</span><span style="color:#79B8FF;" data-v-8c9498c0> pinnedChats</span><span style="color:#F97583;" data-v-8c9498c0> =</span><span style="color:#B392F0;" data-v-8c9498c0> usePinnedChats</span><span style="color:#E1E4E8;" data-v-8c9498c0>()</span></span></code></pre></li><li data-v-8c9498c0><p data-v-8c9498c0><strong data-v-8c9498c0>Connector components</strong> (using <a href="https://reactjs.org/docs/render-props.html" title="Render Props – React" data-v-8c9498c0>render props</a>) can help if you have a lot of class-based components. Class components cannot use hooks so in these cases you can create an adapter which lets class components access hooks through render props.</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>function</span><span style="color:#B392F0;" data-v-8c9498c0> PinnedChatsConnector</span><span style="color:#E1E4E8;" data-v-8c9498c0>({ </span><span style="color:#FFAB70;" data-v-8c9498c0>children</span><span style="color:#E1E4E8;" data-v-8c9498c0> }) {</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>  const</span><span style="color:#79B8FF;" data-v-8c9498c0> pinnedChats</span><span style="color:#F97583;" data-v-8c9498c0> =</span><span style="color:#B392F0;" data-v-8c9498c0> usePinnedChats</span><span style="color:#E1E4E8;" data-v-8c9498c0>()</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>  return</span><span style="color:#B392F0;" data-v-8c9498c0> children</span><span style="color:#E1E4E8;" data-v-8c9498c0>({ pinnedChats })</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>}</span></span></code></pre></li><li data-v-8c9498c0><p data-v-8c9498c0><a href="https://reactjs.org/docs/higher-order-components.html" title="Higher-Order Components – React" data-v-8c9498c0><strong data-v-8c9498c0>Higher-order components</strong></a> are generally considered legacy. If your code have a lot of higher-order components and you are not ready to rewrite the whole component yet, you can, again, create an adaptor that allows connectors to be used as a HOC.</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>function</span><span style="color:#B392F0;" data-v-8c9498c0> withPinnedChats</span><span style="color:#E1E4E8;" data-v-8c9498c0>(</span><span style="color:#FFAB70;" data-v-8c9498c0>WrappedComponent</span><span style="color:#E1E4E8;" data-v-8c9498c0>) {</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>  return</span><span style="color:#E1E4E8;" data-v-8c9498c0> Object.</span><span style="color:#B392F0;" data-v-8c9498c0>assign</span><span style="color:#E1E4E8;" data-v-8c9498c0>(</span><span style="color:#F97583;" data-v-8c9498c0>function</span><span style="color:#B392F0;" data-v-8c9498c0> WithPinnedChats</span><span style="color:#E1E4E8;" data-v-8c9498c0>(</span><span style="color:#FFAB70;" data-v-8c9498c0>props</span><span style="color:#E1E4E8;" data-v-8c9498c0>) {</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>    return</span><span style="color:#E1E4E8;" data-v-8c9498c0> (</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>      &lt;</span><span style="color:#79B8FF;" data-v-8c9498c0>PinnedChatsConnector</span><span style="color:#E1E4E8;" data-v-8c9498c0>&gt;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        {({ </span><span style="color:#FFAB70;" data-v-8c9498c0>pinnedChats</span><span style="color:#E1E4E8;" data-v-8c9498c0> }) </span><span style="color:#F97583;" data-v-8c9498c0>=&gt;</span><span style="color:#E1E4E8;" data-v-8c9498c0> (</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>          &lt;</span><span style="color:#79B8FF;" data-v-8c9498c0>WrappedComponent</span><span style="color:#E1E4E8;" data-v-8c9498c0> {</span><span style="color:#F97583;" data-v-8c9498c0>...</span><span style="color:#E1E4E8;" data-v-8c9498c0>props} </span><span style="color:#B392F0;" data-v-8c9498c0>pinnedChats</span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#E1E4E8;" data-v-8c9498c0>{pinnedChats} /&gt;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>        )}</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>      &lt;/</span><span style="color:#79B8FF;" data-v-8c9498c0>PinnedChatsConnector</span><span style="color:#E1E4E8;" data-v-8c9498c0>&gt;</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>    )</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>  })</span></span>
<span class="line" data-v-8c9498c0><span style="color:#E1E4E8;" data-v-8c9498c0>}</span></span></code></pre></li></ul><p data-v-8c9498c0>In 2018, I talked about this idea with more examples in my talk <a href="https://www.youtube.com/watch?v=xBa0_b-5XDw" title="Thai Pangsakulyanont: Smells In React Apps" data-v-8c9498c0>Smells in React Apps</a>.</p><!--]--></div>
        </div>
      </main>
      <footer>
        <div
          class="notes-layout-container mx-auto py-4 px-6 text-#8b8685 text-right text-sm"
          id="footerContents"
        >
          <notes-page-footer></notes-page-footer>
        </div>
      </footer>
    </div>
    <script>
window.precompiledNoteBehavior = function(require, exports, module, Vue) {"use strict";Object.defineProperty(exports, "__esModule", {value: true});const __sfc__ = {};
var _vue = require('vue');

const _withScopeId = n => (_vue.pushScopeId.call(void 0, "data-v-8c9498c0"),n=n(),_vue.popScopeId.call(void 0, ),n)
const _hoisted_1 = /*#__PURE__*/_vue.createStaticVNode.call(void 0, "<p data-v-8c9498c0>It’s 2020 but I still see questions everywhere about <em data-v-8c9498c0>“Which state management solutions should I use?”</em> in <a href=\"React\" data-v-8c9498c0>React</a>.</p><ul data-v-8c9498c0><li data-v-8c9498c0>Should I use <a href=\"https://redux.js.org/\" title=\"Redux - A predictable state container for JavaScript apps\" data-v-8c9498c0>Redux</a>? Oh, <a href=\"https://medium.com/@dan_abramov/you-might-not-need-redux-be46360cf367\" title=\"You Might Not Need Redux.\" data-v-8c9498c0>I might not need it</a>?</li><li data-v-8c9498c0>What then? Is <a href=\"https://reactjs.org/docs/faq-state.html#should-i-use-a-state-management-library-like-redux-or-mobx\" title=\"Component State – React\" data-v-8c9498c0>local state</a> enough or do I need <a href=\"https://reactjs.org/docs/context.html\" title=\"Context – React\" data-v-8c9498c0>React Context</a>?</li><li data-v-8c9498c0>How about <a href=\"https://github.com/mobxjs/mobx\" title=\"GitHub - mobxjs/mobx: Simple, scalable state management.\" data-v-8c9498c0>MobX</a> (<a href=\"https://github.com/mobxjs/mobx-state-tree\" title=\"GitHub - mobxjs/mobx-state-tree\" data-v-8c9498c0>mobx-state-tree</a>?), <a href=\"https://recoiljs.org/\" title=\"Recoil\" data-v-8c9498c0>Recoil</a>, <a href=\"https://github.com/storeon/storeon\" title=\"GitHub - storeon/storeon\" data-v-8c9498c0>Storeon</a>, <a href=\"https://github.com/pmndrs/zustand\" title=\"GitHub - pmndrs/zustand\" data-v-8c9498c0>Zustand</a>?</li><li data-v-8c9498c0>Or should I embrace streams/observable and use <a href=\"https://rxjs.dev/\" title=\"RxJS\" data-v-8c9498c0>RxJS</a>?</li><li data-v-8c9498c0>If my backend is GraphQL, should I use dedicated clients like <a href=\"https://github.com/apollographql/apollo-client\" title=\"GitHub - apollographql/apollo-client\" data-v-8c9498c0>Apollo Client</a> or the ones above would be enough?</li><li data-v-8c9498c0>There’s also a new trend on <a href=\"https://epicreact.dev/my-state-management-mistake/\" title=\"My State Management Mistake | Epic React by Kent C. Dodds\" data-v-8c9498c0>“data-fetching libraries” which is higher-level than state-management libraries</a> but still backend agnostic. Or should I just use <a href=\"https://react-query.tanstack.com/\" title=\"React Query - Hooks for fetching, caching and updating ...\" data-v-8c9498c0>React Query</a> or <a href=\"https://github.com/vercel/swr\" title=\"GitHub - vercel/swr: React Hooks library for remote data ...\" data-v-8c9498c0>SWR</a>?</li></ul><p data-v-8c9498c0>After 5 years of experience with React, my opinion is now summed up in this picture (click to view full size):</p><p data-v-8c9498c0><a href=\"https://static.dt.in.th/uploads/2020/11/04/abstract-away-state-management.svg\" data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2020/11/04/abstract-away-state-management.svg\" alt=\"\" data-v-8c9498c0></a></p><p data-v-8c9498c0>Instead of seeking the perfect state management solutions for your use case, remember that as a project grows, its use cases tends to changes, seek to learn how to build well-factored software. The <a href=\"https://programmingisterrible.com/\" title=\"programming is terrible\" data-v-8c9498c0>programming is terrible</a> blog, <a href=\"https://architectelevator.com/\" title=\"The Transformation Architect - The Architect Elevator\" data-v-8c9498c0>The Architect Elevator</a> website, and <a href=\"https://martinfowler.com/\" title=\"martinfowler.com - A website on building software effectively\" data-v-8c9498c0>Martin Fowler</a>’s website are filled with great advice. Then all the solutions out there will become tools that can be wielded <em data-v-8c9498c0>effectively</em>.</p><h2 id=\"why-do-i-recommend-this\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#why-do-i-recommend-this\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Why do I recommend this?</h2><p data-v-8c9498c0>I have observed that a single piece of data will be reused in multiple views. Let’s consider a chat application where you can mark certain chats as pinned.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-1.svg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>Before <a href=\"https://react-query.tanstack.com/\" title=\"React Query - Hooks for fetching, caching and updating ...\" data-v-8c9498c0>React Query</a> existed, I might use <a href=\"https://redux.js.org/\" title=\"Redux - A predictable state container for JavaScript apps\" data-v-8c9498c0>Redux</a> to do this. So naturally, each view component would use <a href=\"https://react-redux.js.org/api/hooks#useselector\" title=\"Hooks | React Redux\" data-v-8c9498c0>useSelector</a> and <a href=\"https://react-redux.js.org/api/hooks#usedispatch\" title=\"Hooks | React Redux\" data-v-8c9498c0>useDispatch</a>.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-2.svg\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>Fast forward to 2020, and now <a href=\"https://react-query.tanstack.com/\" title=\"React Query - Hooks for fetching, caching and updating ...\" data-v-8c9498c0>React Query</a> is a thing. Now I am envy of all the greenfield apps that gets to use it.</p><p data-v-8c9498c0>Looking back, the original implementation we have its full of boilerplate and is bug-ridden. Sometimes the state would not synchronize correctly due to me forgetting to put <code data-v-8c9498c0>useEffect</code> in some places. The buggy code is then copy-and-pasted all over the place.</p><p data-v-8c9498c0>And so, it seems more effective to just switch to React Query. In this case I would use the <a href=\"https://react-query.tanstack.com/docs/guides/queries\" title=\"Guides &amp; Concepts: Queries | React Query | TanStack\" data-v-8c9498c0>useQuery</a> and <a href=\"https://react-query.tanstack.com/docs/guides/mutations\" title=\"Guides &amp; Concepts: Mutations | React Query | TanStack\" data-v-8c9498c0>useMutation</a> hooks instead. But then I would need to change several components. This is a laborious and boring task.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-3.svg\" alt=\"\" data-v-8c9498c0></p><h3 id=\"in-an-alternative-universe\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#in-an-alternative-universe\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>In an alternative universe…</h3><p data-v-8c9498c0>Now, what if, back at that time, I decided that <em data-v-8c9498c0>“UI components should not be aware of what state management solution is being used”</em>?</p><p data-v-8c9498c0>Then after the initial implementation using Redux, I would spend a few minutes <a href=\"https://codesqueeze.com/the-art-of-harvesting-abstraction/\" title=\"The Art of Harvesting Abstraction\" data-v-8c9498c0>harvesting</a> the data-binding code and refactor it into a custom hook.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-4.svg\" alt=\"\" data-v-8c9498c0></p><blockquote data-v-8c9498c0><p data-v-8c9498c0>In the end, what defines a module is what pieces of the system it will never responsible for, rather what it is currently responsible for.</p><p data-v-8c9498c0><cite data-v-8c9498c0>— <a href=\"https://programmingisterrible.com/post/176657481103/repeat-yourself-do-more-than-one-thing-and\" title=\"Repeat yourself, do more than one thing, and rewrite ...\" data-v-8c9498c0>Tef, “Repeat yourself, do more than one thing, and rewrite everything”, programming is terrible</a></cite></p></blockquote><p data-v-8c9498c0>2020 comes and React Query becomes popular. In this alternate reality, the work required of me was much fourfold smaller. The UI components can be blissfully ignorant that behind their backs, the state management solution has been replaced.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2020/11/04/why-abstract-state-5.svg\" alt=\"\" data-v-8c9498c0></p><h2 id=\"decoupling-ui-from-state-management\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#decoupling-ui-from-state-management\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Decoupling UI from state management</h2><p data-v-8c9498c0>Multiple techniques exist:</p><ul data-v-8c9498c0><li data-v-8c9498c0><p data-v-8c9498c0><a href=\"https://reactjs.org/docs/hooks-intro.html\" title=\"Introducing Hooks – React\" data-v-8c9498c0><strong data-v-8c9498c0>Hooks</strong></a> are generally the cleanest solution</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>const</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> pinnedChats</span><span style=\"color:#F97583;\" data-v-8c9498c0> =</span><span style=\"color:#B392F0;\" data-v-8c9498c0> usePinnedChats</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>()</span></span></code></pre></li><li data-v-8c9498c0><p data-v-8c9498c0><strong data-v-8c9498c0>Connector components</strong> (using <a href=\"https://reactjs.org/docs/render-props.html\" title=\"Render Props – React\" data-v-8c9498c0>render props</a>) can help if you have a lot of class-based components. Class components cannot use hooks so in these cases you can create an adapter which lets class components access hooks through render props.</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>function</span><span style=\"color:#B392F0;\" data-v-8c9498c0> PinnedChatsConnector</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>({ </span><span style=\"color:#FFAB70;\" data-v-8c9498c0>children</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> }) {</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>  const</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> pinnedChats</span><span style=\"color:#F97583;\" data-v-8c9498c0> =</span><span style=\"color:#B392F0;\" data-v-8c9498c0> usePinnedChats</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>()</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>  return</span><span style=\"color:#B392F0;\" data-v-8c9498c0> children</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>({ pinnedChats })</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>}</span></span></code></pre></li><li data-v-8c9498c0><p data-v-8c9498c0><a href=\"https://reactjs.org/docs/higher-order-components.html\" title=\"Higher-Order Components – React\" data-v-8c9498c0><strong data-v-8c9498c0>Higher-order components</strong></a> are generally considered legacy. If your code have a lot of higher-order components and you are not ready to rewrite the whole component yet, you can, again, create an adaptor that allows connectors to be used as a HOC.</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>function</span><span style=\"color:#B392F0;\" data-v-8c9498c0> withPinnedChats</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>(</span><span style=\"color:#FFAB70;\" data-v-8c9498c0>WrappedComponent</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>) {</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>  return</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> Object.</span><span style=\"color:#B392F0;\" data-v-8c9498c0>assign</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>(</span><span style=\"color:#F97583;\" data-v-8c9498c0>function</span><span style=\"color:#B392F0;\" data-v-8c9498c0> WithPinnedChats</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>(</span><span style=\"color:#FFAB70;\" data-v-8c9498c0>props</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>) {</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>    return</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> (</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>      &lt;</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>PinnedChatsConnector</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>&gt;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        {({ </span><span style=\"color:#FFAB70;\" data-v-8c9498c0>pinnedChats</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> }) </span><span style=\"color:#F97583;\" data-v-8c9498c0>=&gt;</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> (</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>          &lt;</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>WrappedComponent</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> {</span><span style=\"color:#F97583;\" data-v-8c9498c0>...</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>props} </span><span style=\"color:#B392F0;\" data-v-8c9498c0>pinnedChats</span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>{pinnedChats} /&gt;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>        )}</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>      &lt;/</span><span style=\"color:#79B8FF;\" data-v-8c9498c0>PinnedChatsConnector</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>&gt;</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>    )</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>  })</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#E1E4E8;\" data-v-8c9498c0>}</span></span></code></pre></li></ul><p data-v-8c9498c0>In 2018, I talked about this idea with more examples in my talk <a href=\"https://www.youtube.com/watch?v=xBa0_b-5XDw\" title=\"Thai Pangsakulyanont: Smells In React Apps\" data-v-8c9498c0>Smells in React Apps</a>.</p>", 25)
function render(_ctx, _cache) {
  return _hoisted_1
}
__sfc__.render = render
__sfc__.__scopeId = "data-v-8c9498c0"
__sfc__.__file = "Note.vue"
exports. default = __sfc__};
window.precompiledFrontMatter = {"public":true,"title":"On state management tools in React"};
</script>
  </body>
</html>

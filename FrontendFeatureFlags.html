<!DOCTYPE html>
<html data-precompiled=true lang="en" data-dtinth="true">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/icon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple front-end feature flags | notes.dt.in.th</title><meta property="og:title" content="Simple front-end feature flags" data-source="note">
<meta property="og:image" content="https://screenshot.source.in.th/image/_/notes/FrontendFeatureFlags" data-source="note">
<meta property="og:image:width" content="1800" data-source="note">
<meta property="og:image:height" content="1680" data-source="note">
<link rel="canonical" href="https://notes.dt.in.th/FrontendFeatureFlags" data-source="note">
    <script
      async
      src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"
      integrity="sha256-dY2Ug42wyv3rl+sLVKEg3jbPs8f+hi7tmJ836AxVDwI="
      crossorigin="anonymous"
    ></script>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/blurhash-image@1.0.1/blurhash-image.min.js"
      integrity="sha256-qrUUgTGk7xA7iVCwraHNQjwy2JryA0K4L3DL4qidagQ="
      crossorigin="anonymous"
    ></script>
    <script type="module" crossorigin src="/runtime/index.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/supabase-CjkNZD6A.js">
    <link rel="stylesheet" crossorigin href="/runtime/index.css">
  </head>
  <body class="bg-#252423 text-#e9e8e7 antialiased">
    <header class="h-[58px] bg-#090807 border-b border-#454443 z-20 flex">
      <div class="flex items-center pl-[18px] flex-none">
        <a
          class="flex items-center text-#8b8685 hover:text-#ffffbb text-lg"
          href="/"
          >notes.dt.in.th</a
        >
      </div>
      <div
        class="flex-1 flex items-center text-#8b8685 [&_a:hover]:text-#ffffbb overflow-hidden"
        id="headerMiddle"
      >
        <div class="px-2 flex-none">›</div><div class="truncate"><a title="JavaScript (topic)" href="JavaScript">JavaScript</a></div>
      </div>
      <div
        class="flex items-center px-[18px] flex-none gap-4"
        id="headerToolbar"
      ></div>
    </header>
    <div class="h-entry">
      <main class="bg-#353433" id="main">
        <div class="notes-layout-container mx-auto p-6 py-12" id="mainContents">
          <div class="prose e-content" id="noteContents"><!--[--><h1 id="simple-front-end-feature-flags"><a aria-hidden="true" tabindex="-1" href="#simple-front-end-feature-flags"><span class="icon icon-link"></span></a>Simple front-end feature flags</h1><p><strong>To embrace <a href="https://trunkbaseddevelopment.com/">trunk based development</a> and gain its benefits</strong> we must be able to <a href="https://trunkbaseddevelopment.com/short-lived-feature-branches/">merge pull requests quickly</a> (or <a href="https://trunkbaseddevelopment.com/committing-straight-to-the-trunk/">pushing straight to the main branch</a>). However, in a project that doesn’t have a facility to allow this, it can be challenging.</p><p>Let’s say you are rewriting a complex piece of <a href="JavaScript">JavaScript</a> code.</p><p>Now you’re not sure if your re-written version is correct. You fear that your new version will break on production^[Especially if you work on projects that deploys the main branch to production automatically thanks to tools like <a href="https://vercel.com/">Vercel</a> and <a href="https://netlify.com/">Netlify</a>], so you don’t have the confidence to merge your code until it is very thoroughly tested. <a href="https://trunkbaseddevelopment.com/youre-doing-it-wrong/#duration-of-short-lived-feature-branches">Your branch ends up being long-lived rather than short-lived.</a></p><p>One way to solve this issue is to <strong>allow two versions of code to exist</strong> and create <a href="https://trunkbaseddevelopment.com/feature-flags/"><strong>feature flags</strong></a>. You can go fancy and use tools like <a href="https://www.getunleash.io/">Unleash</a> or <a href="https://launchdarkly.com/">LaunchDarkly</a>, or you can use a simple client-side feature flag implementation shown here.</p><h2 id="client-side-feature-flag-implementation"><a aria-hidden="true" tabindex="-1" href="#client-side-feature-flag-implementation"><span class="icon icon-link"></span></a>Client-side feature flag implementation</h2><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> flagSet</span><span style="color:#F97583;">:</span><span style="color:#B392F0;"> Set</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#79B8FF;">string</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#F97583;">|</span><span style="color:#79B8FF;"> undefined</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> function</span><span style="color:#B392F0;"> isQueryFlagEnabled</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">flagName</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;"> string</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">  if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">flagSet) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    flagSet </span><span style="color:#F97583;">=</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Set</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">      (</span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> URLSearchParams</span><span style="color:#E1E4E8;">(window.location.search).</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;flags&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">||</span><span style="color:#9ECBFF;"> &#39;&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">split</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;,&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(Boolean)</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#F97583;">  return</span><span style="color:#E1E4E8;"> flagSet.</span><span style="color:#B392F0;">has</span><span style="color:#E1E4E8;">(flagName)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><details><summary>JavaScript version</summary><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0"><code><span class="line"><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> flagSet</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> function</span><span style="color:#B392F0;"> isQueryFlagEnabled</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">flagName</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">  if</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">flagSet) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    flagSet </span><span style="color:#F97583;">=</span><span style="color:#F97583;"> new</span><span style="color:#B392F0;"> Set</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">      (</span><span style="color:#F97583;">new</span><span style="color:#B392F0;"> URLSearchParams</span><span style="color:#E1E4E8;">(window.location.search).</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;flags&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">||</span><span style="color:#9ECBFF;"> &#39;&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">split</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;,&#39;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        .</span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(Boolean)</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#F97583;">  return</span><span style="color:#E1E4E8;"> flagSet.</span><span style="color:#B392F0;">has</span><span style="color:#E1E4E8;">(flagName)</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre></details><h2 id="allowing-two-versions-of-code-to-exist-at-the-same-time"><a aria-hidden="true" tabindex="-1" href="#allowing-two-versions-of-code-to-exist-at-the-same-time"><span class="icon icon-link"></span></a>Allowing two versions of code to exist at the same time</h2><p>Instead of rewriting your component in place, replacing the old version, you can keep both versions in your codebase and use the <code>isQueryFlagEnabled</code> function to switch between them like this:</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// Layout.js</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> { isQueryFlagEnabled } </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./QueryFlags&#39;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> LayoutOld </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./LayoutOld&#39;</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> LayoutNew </span><span style="color:#F97583;">from</span><span style="color:#9ECBFF;"> &#39;./LayoutNew&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#F97583;"> default</span><span style="color:#B392F0;"> isQueryFlagEnabled</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;new-layout&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> LayoutNew </span><span style="color:#F97583;">:</span><span style="color:#E1E4E8;"> LayoutOld</span></span></code></pre><h2 id="activating-the-flag"><a aria-hidden="true" tabindex="-1" href="#activating-the-flag"><span class="icon icon-link"></span></a>Activating the flag</h2><p>To activate the flag, add the <code>?flags=new-layout</code> query parameter to the URL.</p><p>Most users will see the old layout, while you can activate the flag during development to work on the new layout. Now you can safely merge your unfinished code into the main branch without the fear of breaking production.</p><!--]--></div>
        </div>
      </main>
      <footer>
        <div
          class="notes-layout-container mx-auto py-4 px-6 text-#8b8685 text-right text-sm"
          id="footerContents"
        >
          <notes-page-footer></notes-page-footer>
        </div>
      </footer>
    </div>
    <script>
window.precompiledNoteBehavior = function(require, exports, module, Vue) {"use strict";Object.defineProperty(exports, "__esModule", {value: true});const __sfc__ = {};
var _vue = require('vue');

const _hoisted_1 = /*#__PURE__*/_vue.createStaticVNode.call(void 0, "<h1 id=\"simple-front-end-feature-flags\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#simple-front-end-feature-flags\"><span class=\"icon icon-link\"></span></a>Simple front-end feature flags</h1><p><strong>To embrace <a href=\"https://trunkbaseddevelopment.com/\">trunk based development</a> and gain its benefits</strong> we must be able to <a href=\"https://trunkbaseddevelopment.com/short-lived-feature-branches/\">merge pull requests quickly</a> (or <a href=\"https://trunkbaseddevelopment.com/committing-straight-to-the-trunk/\">pushing straight to the main branch</a>). However, in a project that doesn’t have a facility to allow this, it can be challenging.</p><p>Let’s say you are rewriting a complex piece of <a href=\"JavaScript\">JavaScript</a> code.</p><p>Now you’re not sure if your re-written version is correct. You fear that your new version will break on production^[Especially if you work on projects that deploys the main branch to production automatically thanks to tools like <a href=\"https://vercel.com/\">Vercel</a> and <a href=\"https://netlify.com/\">Netlify</a>], so you don’t have the confidence to merge your code until it is very thoroughly tested. <a href=\"https://trunkbaseddevelopment.com/youre-doing-it-wrong/#duration-of-short-lived-feature-branches\">Your branch ends up being long-lived rather than short-lived.</a></p><p>One way to solve this issue is to <strong>allow two versions of code to exist</strong> and create <a href=\"https://trunkbaseddevelopment.com/feature-flags/\"><strong>feature flags</strong></a>. You can go fancy and use tools like <a href=\"https://www.getunleash.io/\">Unleash</a> or <a href=\"https://launchdarkly.com/\">LaunchDarkly</a>, or you can use a simple client-side feature flag implementation shown here.</p><h2 id=\"client-side-feature-flag-implementation\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#client-side-feature-flag-implementation\"><span class=\"icon icon-link\"></span></a>Client-side feature flag implementation</h2><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583;\">let</span><span style=\"color:#E1E4E8;\"> flagSet</span><span style=\"color:#F97583;\">:</span><span style=\"color:#B392F0;\"> Set</span><span style=\"color:#E1E4E8;\">&lt;</span><span style=\"color:#79B8FF;\">string</span><span style=\"color:#E1E4E8;\">&gt; </span><span style=\"color:#F97583;\">|</span><span style=\"color:#79B8FF;\"> undefined</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583;\">export</span><span style=\"color:#F97583;\"> function</span><span style=\"color:#B392F0;\"> isQueryFlagEnabled</span><span style=\"color:#E1E4E8;\">(</span><span style=\"color:#FFAB70;\">flagName</span><span style=\"color:#F97583;\">:</span><span style=\"color:#79B8FF;\"> string</span><span style=\"color:#E1E4E8;\">) {</span></span>\n<span class=\"line\"><span style=\"color:#F97583;\">  if</span><span style=\"color:#E1E4E8;\"> (</span><span style=\"color:#F97583;\">!</span><span style=\"color:#E1E4E8;\">flagSet) {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">    flagSet </span><span style=\"color:#F97583;\">=</span><span style=\"color:#F97583;\"> new</span><span style=\"color:#B392F0;\"> Set</span><span style=\"color:#E1E4E8;\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">      (</span><span style=\"color:#F97583;\">new</span><span style=\"color:#B392F0;\"> URLSearchParams</span><span style=\"color:#E1E4E8;\">(window.location.search).</span><span style=\"color:#B392F0;\">get</span><span style=\"color:#E1E4E8;\">(</span><span style=\"color:#9ECBFF;\">&#39;flags&#39;</span><span style=\"color:#E1E4E8;\">) </span><span style=\"color:#F97583;\">||</span><span style=\"color:#9ECBFF;\"> &#39;&#39;</span><span style=\"color:#E1E4E8;\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">        .</span><span style=\"color:#B392F0;\">split</span><span style=\"color:#E1E4E8;\">(</span><span style=\"color:#9ECBFF;\">&#39;,&#39;</span><span style=\"color:#E1E4E8;\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">        .</span><span style=\"color:#B392F0;\">filter</span><span style=\"color:#E1E4E8;\">(Boolean)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">    )</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">  }</span></span>\n<span class=\"line\"><span style=\"color:#F97583;\">  return</span><span style=\"color:#E1E4E8;\"> flagSet.</span><span style=\"color:#B392F0;\">has</span><span style=\"color:#E1E4E8;\">(flagName)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">}</span></span></code></pre><details><summary>JavaScript version</summary><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#F97583;\">let</span><span style=\"color:#E1E4E8;\"> flagSet</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583;\">export</span><span style=\"color:#F97583;\"> function</span><span style=\"color:#B392F0;\"> isQueryFlagEnabled</span><span style=\"color:#E1E4E8;\">(</span><span style=\"color:#FFAB70;\">flagName</span><span style=\"color:#E1E4E8;\">) {</span></span>\n<span class=\"line\"><span style=\"color:#F97583;\">  if</span><span style=\"color:#E1E4E8;\"> (</span><span style=\"color:#F97583;\">!</span><span style=\"color:#E1E4E8;\">flagSet) {</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">    flagSet </span><span style=\"color:#F97583;\">=</span><span style=\"color:#F97583;\"> new</span><span style=\"color:#B392F0;\"> Set</span><span style=\"color:#E1E4E8;\">(</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">      (</span><span style=\"color:#F97583;\">new</span><span style=\"color:#B392F0;\"> URLSearchParams</span><span style=\"color:#E1E4E8;\">(window.location.search).</span><span style=\"color:#B392F0;\">get</span><span style=\"color:#E1E4E8;\">(</span><span style=\"color:#9ECBFF;\">&#39;flags&#39;</span><span style=\"color:#E1E4E8;\">) </span><span style=\"color:#F97583;\">||</span><span style=\"color:#9ECBFF;\"> &#39;&#39;</span><span style=\"color:#E1E4E8;\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">        .</span><span style=\"color:#B392F0;\">split</span><span style=\"color:#E1E4E8;\">(</span><span style=\"color:#9ECBFF;\">&#39;,&#39;</span><span style=\"color:#E1E4E8;\">)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">        .</span><span style=\"color:#B392F0;\">filter</span><span style=\"color:#E1E4E8;\">(Boolean)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">    )</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">  }</span></span>\n<span class=\"line\"><span style=\"color:#F97583;\">  return</span><span style=\"color:#E1E4E8;\"> flagSet.</span><span style=\"color:#B392F0;\">has</span><span style=\"color:#E1E4E8;\">(flagName)</span></span>\n<span class=\"line\"><span style=\"color:#E1E4E8;\">}</span></span></code></pre></details><h2 id=\"allowing-two-versions-of-code-to-exist-at-the-same-time\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#allowing-two-versions-of-code-to-exist-at-the-same-time\"><span class=\"icon icon-link\"></span></a>Allowing two versions of code to exist at the same time</h2><p>Instead of rewriting your component in place, replacing the old version, you can keep both versions in your codebase and use the <code>isQueryFlagEnabled</code> function to switch between them like this:</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#6A737D;\">// Layout.js</span></span>\n<span class=\"line\"><span style=\"color:#F97583;\">import</span><span style=\"color:#E1E4E8;\"> { isQueryFlagEnabled } </span><span style=\"color:#F97583;\">from</span><span style=\"color:#9ECBFF;\"> &#39;./QueryFlags&#39;</span></span>\n<span class=\"line\"><span style=\"color:#F97583;\">import</span><span style=\"color:#E1E4E8;\"> LayoutOld </span><span style=\"color:#F97583;\">from</span><span style=\"color:#9ECBFF;\"> &#39;./LayoutOld&#39;</span></span>\n<span class=\"line\"><span style=\"color:#F97583;\">import</span><span style=\"color:#E1E4E8;\"> LayoutNew </span><span style=\"color:#F97583;\">from</span><span style=\"color:#9ECBFF;\"> &#39;./LayoutNew&#39;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#F97583;\">export</span><span style=\"color:#F97583;\"> default</span><span style=\"color:#B392F0;\"> isQueryFlagEnabled</span><span style=\"color:#E1E4E8;\">(</span><span style=\"color:#9ECBFF;\">&#39;new-layout&#39;</span><span style=\"color:#E1E4E8;\">) </span><span style=\"color:#F97583;\">?</span><span style=\"color:#E1E4E8;\"> LayoutNew </span><span style=\"color:#F97583;\">:</span><span style=\"color:#E1E4E8;\"> LayoutOld</span></span></code></pre><h2 id=\"activating-the-flag\"><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#activating-the-flag\"><span class=\"icon icon-link\"></span></a>Activating the flag</h2><p>To activate the flag, add the <code>?flags=new-layout</code> query parameter to the URL.</p><p>Most users will see the old layout, while you can activate the flag during development to work on the new layout. Now you can safely merge your unfinished code into the main branch without the fear of breaking production.</p>", 14)
function render(_ctx, _cache) {
  return _hoisted_1
}
__sfc__.render = render
__sfc__.__file = "Note.vue"
exports. default = __sfc__};
window.precompiledFrontMatter = {"public":true,"title":"Simple front-end feature flags","aliases":["20220427T191347Z4847"]};
</script>
  </body>
</html>

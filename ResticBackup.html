<!DOCTYPE html>
<html data-precompiled=true lang="en" data-dtinth="true">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/icon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Backing up a Linux cloud server with Restic | notes.dt.in.th</title><meta property="og:title" content="Backing up a Linux cloud server with Restic" data-source="note">
<meta property="og:image" content="https://screenshot.source.in.th/image/_/notes/ResticBackup" data-source="note">
<meta property="og:image:width" content="1800" data-source="note">
<meta property="og:image:height" content="1680" data-source="note">
<link rel="canonical" href="https://notes.dt.in.th/ResticBackup" data-source="note"><style id="note-styles">/* layer: default */
.sr-only[data-v-8c9498c0]{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0;}
.static[data-v-8c9498c0]{position:static;}
.me[data-v-8c9498c0]{margin-inline-end:1rem;}</style>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"
      integrity="sha256-dY2Ug42wyv3rl+sLVKEg3jbPs8f+hi7tmJ836AxVDwI="
      crossorigin="anonymous"
    ></script>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/blurhash-image@1.0.1/blurhash-image.min.js"
      integrity="sha256-qrUUgTGk7xA7iVCwraHNQjwy2JryA0K4L3DL4qidagQ="
      crossorigin="anonymous"
    ></script>
    <script type="module" crossorigin src="/runtime/index.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/supabase-CjkNZD6A.js">
    <link rel="stylesheet" crossorigin href="/runtime/index.css">
  </head>
  <body class="bg-#252423 text-#e9e8e7 antialiased">
    <header class="h-[58px] bg-#090807 border-b border-#454443 z-20 flex">
      <div class="flex items-center pl-[18px] flex-none">
        <a
          class="flex items-center text-#8b8685 hover:text-#ffffbb text-lg"
          href="/"
          >notes.dt.in.th</a
        >
      </div>
      <div
        class="flex-1 flex items-center text-#8b8685 [&_a:hover]:text-#ffffbb overflow-hidden"
        id="headerMiddle"
      >
        <div class="px-2 flex-none">›</div><div class="truncate"><a title="Recent writings" href="Recent">Recent writings</a></div>
      </div>
      <div
        class="flex items-center px-[18px] flex-none gap-4"
        id="headerToolbar"
      ></div>
    </header>
    <div class="h-entry">
      <main class="bg-#353433" id="main">
        <div class="notes-layout-container mx-auto p-6 py-12" id="mainContents">
          <div class="prose e-content" id="noteContents"><!--[--><h1 id="backing-up-a-linux-cloud-server-with-restic" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#backing-up-a-linux-cloud-server-with-restic" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Backing up a Linux cloud server with Restic</h1><p data-v-8c9498c0>To save on cloud costs, I want to decommission some old cloud servers. But before I do that, just to be safe, I wanted to back up the data on the it. Unfortunately, many cloud providers doesn’t let you download the snapshot of the VM.</p><p data-v-8c9498c0><a href="https://restic.readthedocs.io/en/stable/" data-v-8c9498c0><strong data-v-8c9498c0>Restic</strong></a> is a modern backup tool <em data-v-8c9498c0>(“Backups done right!”)</em><sup data-v-8c9498c0><a href="#user-content-fn-discovery" id="user-content-fnref-discovery" data-footnote-ref="" aria-describedby="footnote-label" data-v-8c9498c0>1</a></sup>. It is shipped as a static binary, so it can run on an old <a href="Linux" data-v-8c9498c0>Linux</a> cloud server<sup data-v-8c9498c0><a href="#user-content-fn-old" id="user-content-fnref-old" data-footnote-ref="" aria-describedby="footnote-label" data-v-8c9498c0>2</a></sup>.</p><h2 id="downloading-the-binary" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#downloading-the-binary" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Downloading the binary</h2><p data-v-8c9498c0>The latest release can be found at <a href="https://github.com/restic/restic/releases" data-v-8c9498c0>https://github.com/restic/restic/releases</a>.</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># Make sure to replace the version number and CPU architecture in the URL.</span></span>
<span class="line" data-v-8c9498c0><span style="color:#B392F0;" data-v-8c9498c0>wget</span><span style="color:#9ECBFF;" data-v-8c9498c0> https://github.com/restic/restic/releases/download/v0.15.2/restic_0.15.2_linux_amd64.bz2</span><span style="color:#79B8FF;" data-v-8c9498c0> -O</span><span style="color:#9ECBFF;" data-v-8c9498c0> restic.bz2</span></span>
<span class="line" data-v-8c9498c0></span>
<span class="line" data-v-8c9498c0><span style="color:#B392F0;" data-v-8c9498c0>bzip2</span><span style="color:#79B8FF;" data-v-8c9498c0> -d</span><span style="color:#9ECBFF;" data-v-8c9498c0> restic.bz2</span></span>
<span class="line" data-v-8c9498c0><span style="color:#B392F0;" data-v-8c9498c0>chmod</span><span style="color:#9ECBFF;" data-v-8c9498c0> +x</span><span style="color:#9ECBFF;" data-v-8c9498c0> restic</span></span>
<span class="line" data-v-8c9498c0><span style="color:#B392F0;" data-v-8c9498c0>mv</span><span style="color:#9ECBFF;" data-v-8c9498c0> restic</span><span style="color:#9ECBFF;" data-v-8c9498c0> /usr/local/bin/restic</span></span></code></pre><h2 id="creating-a-repository" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#creating-a-repository" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Creating a repository</h2><p data-v-8c9498c0>A <a href="https://restic.readthedocs.io/en/stable/030_preparing_a_new_repo.html" data-v-8c9498c0>repository</a> holds the backup data. It can be stored in a local directory, or in a cloud storage. I will use <a href="https://www.linode.com/products/object-storage/" data-v-8c9498c0>Linode’s Object Storage</a> (<a href="https://www.linode.com/lp/refer/?r=bbaf5d3f89469ec79343da7e08de7c60f664084a" data-v-8c9498c0>my referral link</a>).</p><p data-v-8c9498c0>You can create a repository for each server, but you can also <a href="https://restic.readthedocs.io/en/stable/040_backup.html#:~:text=In%20fact%20several%20hosts%20may%20use%20the%20same%20repository%20to%20backup%20directories%20and%20files%20leading%20to%20a%20greater%20de%2Dduplication." data-v-8c9498c0>create a single repository for all servers, which leads to a better de-duplication.</a>.</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># Set the repository</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>export</span><span style="color:#E1E4E8;" data-v-8c9498c0> RESTIC_REPOSITORY</span><span style="color:#F97583;" data-v-8c9498c0>=</span><span style="color:#9ECBFF;" data-v-8c9498c0>&quot;s3:https://&lt;region&gt;.linodeobjects.com/&lt;bucket-name&gt;/&lt;subdirectory&gt;&quot;</span></span>
<span class="line" data-v-8c9498c0></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># Set the password for accessing the repository</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>export</span><span style="color:#E1E4E8;" data-v-8c9498c0> RESTIC_PASSWORD</span><span style="color:#F97583;" data-v-8c9498c0>=</span></span>
<span class="line" data-v-8c9498c0></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># Set the access keys for S3-compatible storage</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>export</span><span style="color:#E1E4E8;" data-v-8c9498c0> AWS_ACCESS_KEY_ID</span><span style="color:#F97583;" data-v-8c9498c0>=</span></span>
<span class="line" data-v-8c9498c0><span style="color:#F97583;" data-v-8c9498c0>export</span><span style="color:#E1E4E8;" data-v-8c9498c0> AWS_SECRET_ACCESS_KEY</span><span style="color:#F97583;" data-v-8c9498c0>=</span></span>
<span class="line" data-v-8c9498c0></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># If you are on a very old machine like me (Ubuntu 14.04), HTTPS may</span></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># no longer work due to outdated CA certificate store. On a system this</span></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># old, `apt update` no longer works. As a workaround, you can download</span></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># the latest cacert.pem from https://curl.se/docs/caextract.html and set</span></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># the environment variable SSL_CERT_FILE to point to the downloaded file.</span></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># export SSL_CERT_FILE=cacert.pem</span></span>
<span class="line" data-v-8c9498c0></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># Initialize the repository</span></span>
<span class="line" data-v-8c9498c0><span style="color:#B392F0;" data-v-8c9498c0>restic</span><span style="color:#9ECBFF;" data-v-8c9498c0> init</span></span></code></pre><h2 id="backing-up" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#backing-up" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Backing up</h2><p data-v-8c9498c0>Thankfully, buried in the <a href="https://restic.readthedocs.io/en/stable/080_examples.html" data-v-8c9498c0>documentation</a> is a command for backing up a Linux server:</p><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># Based on the command from the docs</span></span>
<span class="line" data-v-8c9498c0><span style="color:#B392F0;" data-v-8c9498c0>restic</span><span style="color:#79B8FF;" data-v-8c9498c0> --exclude=</span><span style="color:#E1E4E8;" data-v-8c9498c0>{</span><span style="color:#B392F0;" data-v-8c9498c0>/dev,/media,/mnt,/proc,/run,/sys,/tmp,/var/tmp}</span><span style="color:#9ECBFF;" data-v-8c9498c0> backup</span><span style="color:#9ECBFF;" data-v-8c9498c0> /</span></span>
<span class="line" data-v-8c9498c0></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># My version</span></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># - It excludes /swapfile, which is a file used for swap space.</span></span>
<span class="line" data-v-8c9498c0><span style="color:#6A737D;" data-v-8c9498c0># - It incudes /mnt, which is usually used for volumes.</span></span>
<span class="line" data-v-8c9498c0><span style="color:#B392F0;" data-v-8c9498c0>restic</span><span style="color:#79B8FF;" data-v-8c9498c0> --exclude=</span><span style="color:#E1E4E8;" data-v-8c9498c0>{</span><span style="color:#B392F0;" data-v-8c9498c0>/dev,/media,/proc,/run,/sys,/tmp,/var/tmp,/swapfile}</span><span style="color:#9ECBFF;" data-v-8c9498c0> backup</span><span style="color:#9ECBFF;" data-v-8c9498c0> /</span></span></code></pre><h2 id="listing-snapshots" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#listing-snapshots" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Listing snapshots</h2><pre class="shiki github-dark" style="background-color:#252423;color:#e1e4e8;" tabindex="0" data-v-8c9498c0><code data-v-8c9498c0><span class="line" data-v-8c9498c0><span style="color:#B392F0;" data-v-8c9498c0>restic</span><span style="color:#9ECBFF;" data-v-8c9498c0> snapshots</span></span></code></pre><p data-v-8c9498c0><a href="https://restic.readthedocs.io/en/stable/045_working_with_repos.html#listing-all-snapshots" data-v-8c9498c0>More info in the docs.</a></p><h2 id="further-reading" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#further-reading" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Further reading</h2><ul data-v-8c9498c0><li data-v-8c9498c0><a href="https://restic.readthedocs.io/en/stable/050_restore.html" data-v-8c9498c0>Restoring from snapshots</a></li><li data-v-8c9498c0><a href="https://restic.readthedocs.io/en/stable/050_restore.html#printing-files-to-stdout" data-v-8c9498c0>Reading a single file or directory</a></li><li data-v-8c9498c0><a href="https://restic.readthedocs.io/en/stable/050_restore.html#restore-using-mount" data-v-8c9498c0>Mounting a snapshot as a FUSE filesystem</a></li></ul><section data-footnotes="" class="footnotes" data-v-8c9498c0><h2 id="footnote-label" class="sr-only" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#footnote-label" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Footnotes</h2><ol data-v-8c9498c0><li id="user-content-fn-discovery" data-v-8c9498c0><p data-v-8c9498c0>I discovered this tool because it’s a backup tool of choice for <a href="https://canasta.wiki/" data-v-8c9498c0>Canasta</a>. <a href="#user-content-fnref-discovery" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref" data-v-8c9498c0>↩</a></p></li><li id="user-content-fn-old" data-v-8c9498c0><p data-v-8c9498c0>My pet cloud server is very old — it is running the Ubuntu 14.04 (Trusty). It is 8 years old already. Thankfully, Restic still works on it. <a href="#user-content-fnref-old" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref" data-v-8c9498c0>↩</a></p></li></ol></section><!--]--></div>
        </div>
      </main>
      <footer>
        <div
          class="notes-layout-container mx-auto py-4 px-6 text-#8b8685 text-right text-sm"
          id="footerContents"
        >
          <notes-page-footer></notes-page-footer>
        </div>
      </footer>
    </div>
    <script>
window.precompiledNoteBehavior = function(require, exports, module, Vue) {"use strict";Object.defineProperty(exports, "__esModule", {value: true});const __sfc__ = {};
var _vue = require('vue');

const _withScopeId = n => (_vue.pushScopeId.call(void 0, "data-v-8c9498c0"),n=n(),_vue.popScopeId.call(void 0, ),n)
const _hoisted_1 = /*#__PURE__*/_vue.createStaticVNode.call(void 0, "<h1 id=\"backing-up-a-linux-cloud-server-with-restic\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#backing-up-a-linux-cloud-server-with-restic\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Backing up a Linux cloud server with Restic</h1><p data-v-8c9498c0>To save on cloud costs, I want to decommission some old cloud servers. But before I do that, just to be safe, I wanted to back up the data on the it. Unfortunately, many cloud providers doesn’t let you download the snapshot of the VM.</p><p data-v-8c9498c0><a href=\"https://restic.readthedocs.io/en/stable/\" data-v-8c9498c0><strong data-v-8c9498c0>Restic</strong></a> is a modern backup tool <em data-v-8c9498c0>(“Backups done right!”)</em><sup data-v-8c9498c0><a href=\"#user-content-fn-discovery\" id=\"user-content-fnref-discovery\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\" data-v-8c9498c0>1</a></sup>. It is shipped as a static binary, so it can run on an old <a href=\"Linux\" data-v-8c9498c0>Linux</a> cloud server<sup data-v-8c9498c0><a href=\"#user-content-fn-old\" id=\"user-content-fnref-old\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\" data-v-8c9498c0>2</a></sup>.</p><h2 id=\"downloading-the-binary\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#downloading-the-binary\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Downloading the binary</h2><p data-v-8c9498c0>The latest release can be found at <a href=\"https://github.com/restic/restic/releases\" data-v-8c9498c0>https://github.com/restic/restic/releases</a>.</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># Make sure to replace the version number and CPU architecture in the URL.</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#B392F0;\" data-v-8c9498c0>wget</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> https://github.com/restic/restic/releases/download/v0.15.2/restic_0.15.2_linux_amd64.bz2</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> -O</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> restic.bz2</span></span>\n<span class=\"line\" data-v-8c9498c0></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#B392F0;\" data-v-8c9498c0>bzip2</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> -d</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> restic.bz2</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#B392F0;\" data-v-8c9498c0>chmod</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> +x</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> restic</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#B392F0;\" data-v-8c9498c0>mv</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> restic</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> /usr/local/bin/restic</span></span></code></pre><h2 id=\"creating-a-repository\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#creating-a-repository\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Creating a repository</h2><p data-v-8c9498c0>A <a href=\"https://restic.readthedocs.io/en/stable/030_preparing_a_new_repo.html\" data-v-8c9498c0>repository</a> holds the backup data. It can be stored in a local directory, or in a cloud storage. I will use <a href=\"https://www.linode.com/products/object-storage/\" data-v-8c9498c0>Linode’s Object Storage</a> (<a href=\"https://www.linode.com/lp/refer/?r=bbaf5d3f89469ec79343da7e08de7c60f664084a\" data-v-8c9498c0>my referral link</a>).</p><p data-v-8c9498c0>You can create a repository for each server, but you can also <a href=\"https://restic.readthedocs.io/en/stable/040_backup.html#:~:text=In%20fact%20several%20hosts%20may%20use%20the%20same%20repository%20to%20backup%20directories%20and%20files%20leading%20to%20a%20greater%20de%2Dduplication.\" data-v-8c9498c0>create a single repository for all servers, which leads to a better de-duplication.</a>.</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># Set the repository</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>export</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> RESTIC_REPOSITORY</span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0>&quot;s3:https://&lt;region&gt;.linodeobjects.com/&lt;bucket-name&gt;/&lt;subdirectory&gt;&quot;</span></span>\n<span class=\"line\" data-v-8c9498c0></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># Set the password for accessing the repository</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>export</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> RESTIC_PASSWORD</span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span></span>\n<span class=\"line\" data-v-8c9498c0></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># Set the access keys for S3-compatible storage</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>export</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> AWS_ACCESS_KEY_ID</span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#F97583;\" data-v-8c9498c0>export</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0> AWS_SECRET_ACCESS_KEY</span><span style=\"color:#F97583;\" data-v-8c9498c0>=</span></span>\n<span class=\"line\" data-v-8c9498c0></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># If you are on a very old machine like me (Ubuntu 14.04), HTTPS may</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># no longer work due to outdated CA certificate store. On a system this</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># old, `apt update` no longer works. As a workaround, you can download</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># the latest cacert.pem from https://curl.se/docs/caextract.html and set</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># the environment variable SSL_CERT_FILE to point to the downloaded file.</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># export SSL_CERT_FILE=cacert.pem</span></span>\n<span class=\"line\" data-v-8c9498c0></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># Initialize the repository</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#B392F0;\" data-v-8c9498c0>restic</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> init</span></span></code></pre><h2 id=\"backing-up\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#backing-up\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Backing up</h2><p data-v-8c9498c0>Thankfully, buried in the <a href=\"https://restic.readthedocs.io/en/stable/080_examples.html\" data-v-8c9498c0>documentation</a> is a command for backing up a Linux server:</p><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># Based on the command from the docs</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#B392F0;\" data-v-8c9498c0>restic</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> --exclude=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>{</span><span style=\"color:#B392F0;\" data-v-8c9498c0>/dev,/media,/mnt,/proc,/run,/sys,/tmp,/var/tmp}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> backup</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> /</span></span>\n<span class=\"line\" data-v-8c9498c0></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># My version</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># - It excludes /swapfile, which is a file used for swap space.</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#6A737D;\" data-v-8c9498c0># - It incudes /mnt, which is usually used for volumes.</span></span>\n<span class=\"line\" data-v-8c9498c0><span style=\"color:#B392F0;\" data-v-8c9498c0>restic</span><span style=\"color:#79B8FF;\" data-v-8c9498c0> --exclude=</span><span style=\"color:#E1E4E8;\" data-v-8c9498c0>{</span><span style=\"color:#B392F0;\" data-v-8c9498c0>/dev,/media,/proc,/run,/sys,/tmp,/var/tmp,/swapfile}</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> backup</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> /</span></span></code></pre><h2 id=\"listing-snapshots\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#listing-snapshots\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Listing snapshots</h2><pre class=\"shiki github-dark\" style=\"background-color:#252423;color:#e1e4e8;\" tabindex=\"0\" data-v-8c9498c0><code data-v-8c9498c0><span class=\"line\" data-v-8c9498c0><span style=\"color:#B392F0;\" data-v-8c9498c0>restic</span><span style=\"color:#9ECBFF;\" data-v-8c9498c0> snapshots</span></span></code></pre><p data-v-8c9498c0><a href=\"https://restic.readthedocs.io/en/stable/045_working_with_repos.html#listing-all-snapshots\" data-v-8c9498c0>More info in the docs.</a></p><h2 id=\"further-reading\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#further-reading\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Further reading</h2><ul data-v-8c9498c0><li data-v-8c9498c0><a href=\"https://restic.readthedocs.io/en/stable/050_restore.html\" data-v-8c9498c0>Restoring from snapshots</a></li><li data-v-8c9498c0><a href=\"https://restic.readthedocs.io/en/stable/050_restore.html#printing-files-to-stdout\" data-v-8c9498c0>Reading a single file or directory</a></li><li data-v-8c9498c0><a href=\"https://restic.readthedocs.io/en/stable/050_restore.html#restore-using-mount\" data-v-8c9498c0>Mounting a snapshot as a FUSE filesystem</a></li></ul><section data-footnotes=\"\" class=\"footnotes\" data-v-8c9498c0><h2 id=\"footnote-label\" class=\"sr-only\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#footnote-label\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Footnotes</h2><ol data-v-8c9498c0><li id=\"user-content-fn-discovery\" data-v-8c9498c0><p data-v-8c9498c0>I discovered this tool because it’s a backup tool of choice for <a href=\"https://canasta.wiki/\" data-v-8c9498c0>Canasta</a>. <a href=\"#user-content-fnref-discovery\" data-footnote-backref=\"\" aria-label=\"Back to reference 1\" class=\"data-footnote-backref\" data-v-8c9498c0>↩</a></p></li><li id=\"user-content-fn-old\" data-v-8c9498c0><p data-v-8c9498c0>My pet cloud server is very old — it is running the Ubuntu 14.04 (Trusty). It is 8 years old already. Thankfully, Restic still works on it. <a href=\"#user-content-fnref-old\" data-footnote-backref=\"\" aria-label=\"Back to reference 2\" class=\"data-footnote-backref\" data-v-8c9498c0>↩</a></p></li></ol></section>", 19)
function render(_ctx, _cache) {
  return _hoisted_1
}
__sfc__.render = render
__sfc__.__scopeId = "data-v-8c9498c0"
__sfc__.__file = "Note.vue"
exports. default = __sfc__};
window.precompiledFrontMatter = {"public":true,"title":"Backing up a Linux cloud server with Restic"};
</script>
  </body>
</html>

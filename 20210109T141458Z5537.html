<!DOCTYPE html>
<html data-precompiled=true lang="en" data-dtinth="true">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/icon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A local file storage for the web and interopearability layer for web-based apps (submission) | notes.dt.in.th</title><meta property="og:title" content="A local file storage for the web and interopearability layer for web-based apps (submission)" data-source="note">
<meta property="og:image" content="https://screenshot.source.in.th/image/_/notes/20210109T141458Z5537" data-source="note">
<meta property="og:image:width" content="1800" data-source="note">
<meta property="og:image:height" content="1680" data-source="note">
<link rel="canonical" href="https://notes.dt.in.th/20210109T141458Z5537" data-source="note"><style id="note-styles">/* layer: default */
.static[data-v-8c9498c0]{position:static;}
.my[data-v-8c9498c0]{margin-top:1rem;margin-bottom:1rem;}
.me[data-v-8c9498c0]{margin-inline-end:1rem;}</style>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/iconify-icon@2.1.0/dist/iconify-icon.min.js"
      integrity="sha256-dY2Ug42wyv3rl+sLVKEg3jbPs8f+hi7tmJ836AxVDwI="
      crossorigin="anonymous"
    ></script>
    <script
      async
      src="https://cdn.jsdelivr.net/npm/blurhash-image@1.0.1/blurhash-image.min.js"
      integrity="sha256-qrUUgTGk7xA7iVCwraHNQjwy2JryA0K4L3DL4qidagQ="
      crossorigin="anonymous"
    ></script>
    <script type="module" crossorigin src="/runtime/index.js"></script>
    <link rel="modulepreload" crossorigin href="/assets/supabase-CjkNZD6A.js">
    <link rel="stylesheet" crossorigin href="/runtime/index.css">
  </head>
  <body class="bg-#252423 text-#e9e8e7 antialiased">
    <header class="h-[58px] bg-#090807 border-b border-#454443 z-20 flex">
      <div class="flex items-center pl-[18px] flex-none">
        <a
          class="flex items-center text-#8b8685 hover:text-#ffffbb text-lg"
          href="/"
          >notes.dt.in.th</a
        >
      </div>
      <div
        class="flex-1 flex items-center text-#8b8685 [&_a:hover]:text-#ffffbb overflow-hidden"
        id="headerMiddle"
      >
        <div class="px-2 flex-none">›</div><div class="truncate"><a title="Web Platform (topic)" href="WebPlatform">Web Platform</a></div>
      </div>
      <div
        class="flex items-center px-[18px] flex-none gap-4"
        id="headerToolbar"
      ></div>
    </header>
    <div class="h-entry">
      <main class="bg-#353433" id="main">
        <div class="notes-layout-container mx-auto p-6 py-12" id="mainContents">
          <div class="prose e-content" id="noteContents"><!--[--><h2 id="what-i-built" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#what-i-built" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>What I built</h2><p data-v-8c9498c0>I built <a href="https://tmp.spacet.me/" data-v-8c9498c0>tmp.spacet.me</a>, a <strong data-v-8c9498c0>web-based local file storage application</strong>. Basically, you can put files into it, and you can get files out of it. It aims to support every possible methods that browsers allow web apps to work with files.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2021/01/09/tmp-builtins.png" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>It also comes with an <strong data-v-8c9498c0>extensions system</strong>. Users can add extensions to enhance the functionalities of the app. The goal is to improve <strong data-v-8c9498c0>operability</strong> between web-based applications that work with files.</p><p data-v-8c9498c0>For example, the <a href="https://tmp-docs.spacet.me/tmp-webrtc.html" data-v-8c9498c0>tmp-webrtc</a> extension lets me send files from one device to another using peer-to-peer technology WebRTC.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2021/01/09/image.png" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>The <a href="https://tmp-docs.spacet.me/tmp-photopea.html" data-v-8c9498c0>tmp-photopea</a> extension lets me edit image files in Photopea.</p><p data-v-8c9498c0><img src="https://tmp-docs.spacet.me/images/edit-with-photopea.png" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>Users can build their own extensions to suit their needs.</p><p data-v-8c9498c0>For example, I built an extension to upload images to my static file hosting.</p><p data-v-8c9498c0><img src="https://static.dt.in.th/uploads/2021/01/09/tmp-uploader.png" alt="" data-v-8c9498c0></p><p data-v-8c9498c0>Although tmp.spacet.me is built using React and Next.js, this is just an implementation detail and extension authors don’t need to know any React. That’s because <strong data-v-8c9498c0>extensions run on their own page</strong> and communicate with tmp.spacet.me via the <code data-v-8c9498c0>postMessage</code> API only.</p><h3 id="category-submission" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#category-submission" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Category Submission</h3><p data-v-8c9498c0>Random Roulette</p><h3 id="app-link" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#app-link" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>App Link</h3><p data-v-8c9498c0><a href="https://tmp.spacet.me/" data-v-8c9498c0>https://tmp.spacet.me/</a></p><h3 id="screenshots" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#screenshots" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Screenshots</h3><p data-v-8c9498c0><a href="https://tmp.spacet.me/" data-v-8c9498c0><img src="https://github.com/dtinth/timelapse/blob/master/projects/tmp.spacet.me_initial.png?raw=true" alt="" data-v-8c9498c0></a></p><h3 id="description" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#description" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Description</h3><p data-v-8c9498c0>A web-based local file storage. You can put files into it, and you can get files out of it. More functionalities can be added through extensions.</p><h3 id="link-to-source-code" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#link-to-source-code" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Link to Source Code</h3><p data-v-8c9498c0>{% github dtinth/tmp %}</p><ul data-v-8c9498c0><li data-v-8c9498c0><a href="https://github.com/dtinth/tmp" data-v-8c9498c0>dtinth/tmp</a> — the main app</li><li data-v-8c9498c0><a href="https://github.com/dtinth/tmp-webrtc" data-v-8c9498c0>dtinth/tmp-webrtc</a> — extension to send/receive files over WebRTC</li><li data-v-8c9498c0><a href="https://github.com/dtinth/tmp-photopea" data-v-8c9498c0>dtinth/tmp-photopea</a> — extension to edit pictures in Photopea</li><li data-v-8c9498c0><a href="https://github.com/dtinth/tmp-uploader" data-v-8c9498c0>dtinth/tmp-uploader</a> — extension to let me upload pictures to my static files hosting</li><li data-v-8c9498c0><a href="https://github.com/dtinth/tmp-dtinth" data-v-8c9498c0>dtinth/tmp-dtinth</a> — extension for my personal use cases</li></ul><h3 id="permissive-license" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#permissive-license" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Permissive License</h3><p data-v-8c9498c0>All code is MIT Licensed</p><h2 id="background" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#background" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>Background</h2><p data-v-8c9498c0>There are so many great web-based tools. From <a href="https://stackedit.io/" data-v-8c9498c0>Markdown</a> <a href="https://dillinger.io/" data-v-8c9498c0>editors</a> to <a href="https://www.sharedrop.io/" data-v-8c9498c0>file</a> <a href="http://www.instant.io/" data-v-8c9498c0>sharing</a> <a href="http://webdrop.space/" data-v-8c9498c0>services</a> to <a href="https://www.diagrams.net/" data-v-8c9498c0>diagramming tool</a> to <a href="https://figma.com/" data-v-8c9498c0>design tool</a> to <a href="http://www.photopea.com/" data-v-8c9498c0>image editor</a> and <a href="https://squoosh.app/" data-v-8c9498c0>compressor</a> to <a href="https://vox.spacet.me/" data-v-8c9498c0>voice</a> and <a href="https://gifcap.dev/" data-v-8c9498c0>screen</a> recorder to myriad of cloud storage services, etc.</p><p data-v-8c9498c0>Many of these tools work with files. <a href="https://paul.kinlan.me/unintended-silos/" data-v-8c9498c0>But they tend to be its own silo</a> and do not interoperate with other tools.</p><p data-v-8c9498c0>There has been attempts to solve this from the web platform side. There was an experimental <a href="https://en.wikipedia.org/wiki/Web_Intents" data-v-8c9498c0>Web Intents</a> API which <a href="https://paul.kinlan.me/what-happened-to-web-intents/" data-v-8c9498c0>failed</a>. More recently, there are also the <a href="https://web.dev/web-share/" data-v-8c9498c0>Web Share API</a> and the <a href="https://web.dev/web-share-target/" data-v-8c9498c0>Web Share Target API</a> which integrates natively with the system’s Share dialog. Unfortunately Desktop devices don’t have them and so it’s only available on Android right now.</p><p data-v-8c9498c0>So, as I become more reliant on web-based tools, I want to try my take at a <strong data-v-8c9498c0>userland solution</strong>. So the missing piece, I think, is a central hub, where files can be sent to, which would then be forwarded to other web-based app or saved to disk. I want it to have an extension system, so anyone can build more integrations without having to modify the main app. Furthermore, deeper integrations with existing web-based apps can be implemented via browser extensions.</p><h3 id="how-i-built-it" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#how-i-built-it" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>How I built it</h3><p data-v-8c9498c0>For the main app, <code data-v-8c9498c0>tmp.spacet.me</code>, I used <strong data-v-8c9498c0>DigitalOcean App Platform</strong> to host the app, which is a static web application. The main application is built using <strong data-v-8c9498c0>React</strong> and <strong data-v-8c9498c0>Next.js</strong>. Deployment to DigitalOcean App Platform is very straightforward and I’m impressed by how easy it is to set up. I’m looking forward to support for deployment previews in the future.</p><p data-v-8c9498c0>For the extension system, when the extension URL is entered, the main app fetches the manifest file, which contains the information about the extension, as well as which file types can be handled. Then, when the extension is activated, it opens a separate browser window and communicate with the main app via a <a href="https://www.jsonrpc.org/specification" data-v-8c9498c0>JSON-RPC</a>-based protocol. This gave me opportunities to put cross-site messaging and micro-frontend concepts into practice.</p><p data-v-8c9498c0>For the <code data-v-8c9498c0>tmp-webrtc</code> extension, at first I wanted to create a backend service to implement <a href="https://github.com/feross/simple-peer#a-simpler-example" data-v-8c9498c0>peer discovery</a>. That would also give me an opportunity to try out DigitalOcean’s paid services (like running backend apps and using a managed database). Unfortunately due to time constraints I didn’t get around to doing that and used the <a href="https://github.com/subins2000/p2pt" data-v-8c9498c0>P2PT</a> library for peer discovery instead. P2PT uses public <a href="https://github.com/webtorrent/bittorrent-tracker" data-v-8c9498c0>WebTorrent trackers</a> as a WebRTC signaling server, and so no backend services have to be deployed. So it ended up being another static app. This is my first time using P2PT and WebRTC for file transfers though, so I still think I learned a lot.</p><p data-v-8c9498c0>I really like that DigitalOcean’s App Platform makes setting up CORS very straightforward (can be set up via the console), while <a href="https://community.netlify.com/t/access-control-allow-origin-policy/1813/2" data-v-8c9498c0>Netlify</a>, <a href="https://vercel.com/knowledge/how-to-enable-cors#enabling-cors-using-vercel.json" data-v-8c9498c0>Vercel</a> requires creating a configuration file. Having CORS is crucial for the extension system to work, because <code data-v-8c9498c0>tmp.spacet.me</code> needs to fetch the manifest file to discover the extension&#39;s functionalities.</p><p data-v-8c9498c0>The <code data-v-8c9498c0>tmp-webrtc</code> extension is built using <strong data-v-8c9498c0>Vue 3</strong> and <strong data-v-8c9498c0>Vite</strong>. I have never used Vite before, so that’s another thing I learned. By the way, I don’t like running commands to generate new projects, so <a href="https://dev.to/dtinth/freshly-baked-apps-every-midnight-1h99" data-v-8c9498c0>I took the opportunity to shave that yak, and created the Fresh App Factory</a>.</p><p data-v-8c9498c0>I also used other other cloud services other than DigialOcean. The <a href="https://tmp-docs.spacet.me/" data-v-8c9498c0>documentation site</a> is just a Jekyll site hosted on GitHub Pages, which I chose for simplicity. I like that DigitalOcean App Platform allows multiple static apps (or “components”) to be hosted on the same domain, but I could not get Jekyll to work on it.</p><p data-v-8c9498c0>The application’s UI is not polished at all and could use a lot of improvements. But I think it’s good enough for a proof-of-concept. Since I started building this, I have been using it a lot in my own personal workflow. Sending pictures and videos between my 4 devices, now I just use tmp.spacet.me.</p><p data-v-8c9498c0>Some areas for future improvements include:</p><ul data-v-8c9498c0><li data-v-8c9498c0>Improving the user experience, accessibility and performance.</li><li data-v-8c9498c0>Allowing files to be stored temporarily in the in-memory storage first before committing to PouchDB.</li><li data-v-8c9498c0>Allowing other web apps to directly <code data-v-8c9498c0>postMessage</code> to tmp.spacet.me (without an extension), reducing the irony.</li></ul><p data-v-8c9498c0>I hope you find the tool useful, and thanks for reading!</p><h2 id="devlog" data-v-8c9498c0><a aria-hidden="true" tabindex="-1" href="#devlog" data-v-8c9498c0><span class="icon icon-link" data-v-8c9498c0></span></a>devlog</h2><ul data-v-8c9498c0><li data-v-8c9498c0><a href="20201216T165355Z3976" data-v-8c9498c0>Part 1</a></li><li data-v-8c9498c0><a href="20201228T140510Z2057" data-v-8c9498c0>Part 2</a></li><li data-v-8c9498c0><a href="20210105T201754Z9386" data-v-8c9498c0>Part 3</a></li><li data-v-8c9498c0><a href="20210107T191402Z9105" data-v-8c9498c0>Part 4</a></li></ul><!--]--></div>
        </div>
      </main>
      <footer>
        <div
          class="notes-layout-container mx-auto py-4 px-6 text-#8b8685 text-right text-sm"
          id="footerContents"
        >
          <notes-page-footer></notes-page-footer>
        </div>
      </footer>
    </div>
    <script>
window.precompiledNoteBehavior = function(require, exports, module, Vue) {"use strict";Object.defineProperty(exports, "__esModule", {value: true});const __sfc__ = {};
var _vue = require('vue');

const _withScopeId = n => (_vue.pushScopeId.call(void 0, "data-v-8c9498c0"),n=n(),_vue.popScopeId.call(void 0, ),n)
const _hoisted_1 = /*#__PURE__*/_vue.createStaticVNode.call(void 0, "<h2 id=\"what-i-built\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#what-i-built\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>What I built</h2><p data-v-8c9498c0>I built <a href=\"https://tmp.spacet.me/\" data-v-8c9498c0>tmp.spacet.me</a>, a <strong data-v-8c9498c0>web-based local file storage application</strong>. Basically, you can put files into it, and you can get files out of it. It aims to support every possible methods that browsers allow web apps to work with files.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2021/01/09/tmp-builtins.png\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>It also comes with an <strong data-v-8c9498c0>extensions system</strong>. Users can add extensions to enhance the functionalities of the app. The goal is to improve <strong data-v-8c9498c0>operability</strong> between web-based applications that work with files.</p><p data-v-8c9498c0>For example, the <a href=\"https://tmp-docs.spacet.me/tmp-webrtc.html\" data-v-8c9498c0>tmp-webrtc</a> extension lets me send files from one device to another using peer-to-peer technology WebRTC.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2021/01/09/image.png\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>The <a href=\"https://tmp-docs.spacet.me/tmp-photopea.html\" data-v-8c9498c0>tmp-photopea</a> extension lets me edit image files in Photopea.</p><p data-v-8c9498c0><img src=\"https://tmp-docs.spacet.me/images/edit-with-photopea.png\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>Users can build their own extensions to suit their needs.</p><p data-v-8c9498c0>For example, I built an extension to upload images to my static file hosting.</p><p data-v-8c9498c0><img src=\"https://static.dt.in.th/uploads/2021/01/09/tmp-uploader.png\" alt=\"\" data-v-8c9498c0></p><p data-v-8c9498c0>Although tmp.spacet.me is built using React and Next.js, this is just an implementation detail and extension authors don’t need to know any React. That’s because <strong data-v-8c9498c0>extensions run on their own page</strong> and communicate with tmp.spacet.me via the <code data-v-8c9498c0>postMessage</code> API only.</p><h3 id=\"category-submission\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#category-submission\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Category Submission</h3><p data-v-8c9498c0>Random Roulette</p><h3 id=\"app-link\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#app-link\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>App Link</h3><p data-v-8c9498c0><a href=\"https://tmp.spacet.me/\" data-v-8c9498c0>https://tmp.spacet.me/</a></p><h3 id=\"screenshots\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#screenshots\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Screenshots</h3><p data-v-8c9498c0><a href=\"https://tmp.spacet.me/\" data-v-8c9498c0><img src=\"https://github.com/dtinth/timelapse/blob/master/projects/tmp.spacet.me_initial.png?raw=true\" alt=\"\" data-v-8c9498c0></a></p><h3 id=\"description\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#description\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Description</h3><p data-v-8c9498c0>A web-based local file storage. You can put files into it, and you can get files out of it. More functionalities can be added through extensions.</p><h3 id=\"link-to-source-code\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#link-to-source-code\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Link to Source Code</h3><p data-v-8c9498c0>{% github dtinth/tmp %}</p><ul data-v-8c9498c0><li data-v-8c9498c0><a href=\"https://github.com/dtinth/tmp\" data-v-8c9498c0>dtinth/tmp</a> — the main app</li><li data-v-8c9498c0><a href=\"https://github.com/dtinth/tmp-webrtc\" data-v-8c9498c0>dtinth/tmp-webrtc</a> — extension to send/receive files over WebRTC</li><li data-v-8c9498c0><a href=\"https://github.com/dtinth/tmp-photopea\" data-v-8c9498c0>dtinth/tmp-photopea</a> — extension to edit pictures in Photopea</li><li data-v-8c9498c0><a href=\"https://github.com/dtinth/tmp-uploader\" data-v-8c9498c0>dtinth/tmp-uploader</a> — extension to let me upload pictures to my static files hosting</li><li data-v-8c9498c0><a href=\"https://github.com/dtinth/tmp-dtinth\" data-v-8c9498c0>dtinth/tmp-dtinth</a> — extension for my personal use cases</li></ul><h3 id=\"permissive-license\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#permissive-license\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Permissive License</h3><p data-v-8c9498c0>All code is MIT Licensed</p><h2 id=\"background\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#background\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>Background</h2><p data-v-8c9498c0>There are so many great web-based tools. From <a href=\"https://stackedit.io/\" data-v-8c9498c0>Markdown</a> <a href=\"https://dillinger.io/\" data-v-8c9498c0>editors</a> to <a href=\"https://www.sharedrop.io/\" data-v-8c9498c0>file</a> <a href=\"http://www.instant.io/\" data-v-8c9498c0>sharing</a> <a href=\"http://webdrop.space/\" data-v-8c9498c0>services</a> to <a href=\"https://www.diagrams.net/\" data-v-8c9498c0>diagramming tool</a> to <a href=\"https://figma.com/\" data-v-8c9498c0>design tool</a> to <a href=\"http://www.photopea.com/\" data-v-8c9498c0>image editor</a> and <a href=\"https://squoosh.app/\" data-v-8c9498c0>compressor</a> to <a href=\"https://vox.spacet.me/\" data-v-8c9498c0>voice</a> and <a href=\"https://gifcap.dev/\" data-v-8c9498c0>screen</a> recorder to myriad of cloud storage services, etc.</p><p data-v-8c9498c0>Many of these tools work with files. <a href=\"https://paul.kinlan.me/unintended-silos/\" data-v-8c9498c0>But they tend to be its own silo</a> and do not interoperate with other tools.</p><p data-v-8c9498c0>There has been attempts to solve this from the web platform side. There was an experimental <a href=\"https://en.wikipedia.org/wiki/Web_Intents\" data-v-8c9498c0>Web Intents</a> API which <a href=\"https://paul.kinlan.me/what-happened-to-web-intents/\" data-v-8c9498c0>failed</a>. More recently, there are also the <a href=\"https://web.dev/web-share/\" data-v-8c9498c0>Web Share API</a> and the <a href=\"https://web.dev/web-share-target/\" data-v-8c9498c0>Web Share Target API</a> which integrates natively with the system’s Share dialog. Unfortunately Desktop devices don’t have them and so it’s only available on Android right now.</p><p data-v-8c9498c0>So, as I become more reliant on web-based tools, I want to try my take at a <strong data-v-8c9498c0>userland solution</strong>. So the missing piece, I think, is a central hub, where files can be sent to, which would then be forwarded to other web-based app or saved to disk. I want it to have an extension system, so anyone can build more integrations without having to modify the main app. Furthermore, deeper integrations with existing web-based apps can be implemented via browser extensions.</p><h3 id=\"how-i-built-it\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#how-i-built-it\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>How I built it</h3><p data-v-8c9498c0>For the main app, <code data-v-8c9498c0>tmp.spacet.me</code>, I used <strong data-v-8c9498c0>DigitalOcean App Platform</strong> to host the app, which is a static web application. The main application is built using <strong data-v-8c9498c0>React</strong> and <strong data-v-8c9498c0>Next.js</strong>. Deployment to DigitalOcean App Platform is very straightforward and I’m impressed by how easy it is to set up. I’m looking forward to support for deployment previews in the future.</p><p data-v-8c9498c0>For the extension system, when the extension URL is entered, the main app fetches the manifest file, which contains the information about the extension, as well as which file types can be handled. Then, when the extension is activated, it opens a separate browser window and communicate with the main app via a <a href=\"https://www.jsonrpc.org/specification\" data-v-8c9498c0>JSON-RPC</a>-based protocol. This gave me opportunities to put cross-site messaging and micro-frontend concepts into practice.</p><p data-v-8c9498c0>For the <code data-v-8c9498c0>tmp-webrtc</code> extension, at first I wanted to create a backend service to implement <a href=\"https://github.com/feross/simple-peer#a-simpler-example\" data-v-8c9498c0>peer discovery</a>. That would also give me an opportunity to try out DigitalOcean’s paid services (like running backend apps and using a managed database). Unfortunately due to time constraints I didn’t get around to doing that and used the <a href=\"https://github.com/subins2000/p2pt\" data-v-8c9498c0>P2PT</a> library for peer discovery instead. P2PT uses public <a href=\"https://github.com/webtorrent/bittorrent-tracker\" data-v-8c9498c0>WebTorrent trackers</a> as a WebRTC signaling server, and so no backend services have to be deployed. So it ended up being another static app. This is my first time using P2PT and WebRTC for file transfers though, so I still think I learned a lot.</p><p data-v-8c9498c0>I really like that DigitalOcean’s App Platform makes setting up CORS very straightforward (can be set up via the console), while <a href=\"https://community.netlify.com/t/access-control-allow-origin-policy/1813/2\" data-v-8c9498c0>Netlify</a>, <a href=\"https://vercel.com/knowledge/how-to-enable-cors#enabling-cors-using-vercel.json\" data-v-8c9498c0>Vercel</a> requires creating a configuration file. Having CORS is crucial for the extension system to work, because <code data-v-8c9498c0>tmp.spacet.me</code> needs to fetch the manifest file to discover the extension&#39;s functionalities.</p><p data-v-8c9498c0>The <code data-v-8c9498c0>tmp-webrtc</code> extension is built using <strong data-v-8c9498c0>Vue 3</strong> and <strong data-v-8c9498c0>Vite</strong>. I have never used Vite before, so that’s another thing I learned. By the way, I don’t like running commands to generate new projects, so <a href=\"https://dev.to/dtinth/freshly-baked-apps-every-midnight-1h99\" data-v-8c9498c0>I took the opportunity to shave that yak, and created the Fresh App Factory</a>.</p><p data-v-8c9498c0>I also used other other cloud services other than DigialOcean. The <a href=\"https://tmp-docs.spacet.me/\" data-v-8c9498c0>documentation site</a> is just a Jekyll site hosted on GitHub Pages, which I chose for simplicity. I like that DigitalOcean App Platform allows multiple static apps (or “components”) to be hosted on the same domain, but I could not get Jekyll to work on it.</p><p data-v-8c9498c0>The application’s UI is not polished at all and could use a lot of improvements. But I think it’s good enough for a proof-of-concept. Since I started building this, I have been using it a lot in my own personal workflow. Sending pictures and videos between my 4 devices, now I just use tmp.spacet.me.</p><p data-v-8c9498c0>Some areas for future improvements include:</p><ul data-v-8c9498c0><li data-v-8c9498c0>Improving the user experience, accessibility and performance.</li><li data-v-8c9498c0>Allowing files to be stored temporarily in the in-memory storage first before committing to PouchDB.</li><li data-v-8c9498c0>Allowing other web apps to directly <code data-v-8c9498c0>postMessage</code> to tmp.spacet.me (without an extension), reducing the irony.</li></ul><p data-v-8c9498c0>I hope you find the tool useful, and thanks for reading!</p><h2 id=\"devlog\" data-v-8c9498c0><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#devlog\" data-v-8c9498c0><span class=\"icon icon-link\" data-v-8c9498c0></span></a>devlog</h2><ul data-v-8c9498c0><li data-v-8c9498c0><a href=\"20201216T165355Z3976\" data-v-8c9498c0>Part 1</a></li><li data-v-8c9498c0><a href=\"20201228T140510Z2057\" data-v-8c9498c0>Part 2</a></li><li data-v-8c9498c0><a href=\"20210105T201754Z9386\" data-v-8c9498c0>Part 3</a></li><li data-v-8c9498c0><a href=\"20210107T191402Z9105\" data-v-8c9498c0>Part 4</a></li></ul>", 43)
function render(_ctx, _cache) {
  return _hoisted_1
}
__sfc__.render = render
__sfc__.__scopeId = "data-v-8c9498c0"
__sfc__.__file = "Note.vue"
exports. default = __sfc__};
window.precompiledFrontMatter = {"title":"A local file storage for the web and interopearability layer for web-based apps (submission)","description":"My submission to the DigitalOcean App Platform Hackathon!","tags":"dohackathon","series":"tmp.spacet.me devlog","canonical_url":"https://notes.dt.in.th/20210109T141458Z5537","cover_image":"https://static.dt.in.th/uploads/2021/01/10/tmp-cover.png","public":true,"devto":"https://dev.to/dtinth/a-local-file-storage-for-the-web-and-interopearability-layer-for-web-based-apps-submission-1hcf"};
</script>
  </body>
</html>
